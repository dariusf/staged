
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Logic</title><script src="coq2html.js"></script>
<meta name="description" content="Documentation of Coq module Logic" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h1 class="title">Module Logic</h1>
<div class="coq">
<br/>
<span class="kwd">From</span> <span class="id">Stdlib</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Classes.RelationClasses</span>.<br/>
<span class="kwd">From</span> <span class="id">Stdlib</span> <span class="kwd">Require</span> <span class="id">Morphisms</span> <span class="id">Program.Basics</span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="id">Warnings</span> <span class="string">"-notation-incompatible-prefix"</span>.<br/>
<span class="kwd">From</span> <span class="id">Staged</span> <span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">HeapF</span>.<br/>
<span class="kwd">Set</span> <span class="id">Warnings</span> <span class="string">"notation-incompatible-prefix"</span>.<br/>
<span class="kwd">From</span> <span class="id">Staged</span> <span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">LibFmap</span>.<br/>
<span class="kwd">From</span> <span class="id">Staged</span> <span class="kwd">Require</span> <span class="kwd">Export</span> <span class="id">ExtraTactics</span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">string_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="kwd">Arguments</span>.<br/>
<br/>
<span class="kwd">From</span> <span class="id">Stdlib</span> <span class="kwd">Require</span> <span class="id">Recdef</span>.<br/>
<br/>
<br/>
<br/>
<h1> Programs </h1>
<div class="doc">The representation of programs and the use of substitution are mostly reused from SLF. </div>
<span class="kwd">Definition</span> <span class="id">var</span> : <span class="kwd">Type</span> := <span class="id">string</span>.<br/>
<span class="kwd">Definition</span> <span class="id">var_eq</span> := <span class="id">String.string_dec</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">loc</span> := <span class="id">nat</span>.<br/>
<span class="kwd">Inductive</span> <span class="id">val</span> :=<br/>
&nbsp;&nbsp;| <span class="id">vunit</span> : <span class="id">val</span><br/>
&nbsp;&nbsp;| <span class="id">vint</span> : <span class="id">Z</span> -&gt; <span class="id">val</span><br/>
&nbsp;&nbsp;| <span class="id">vfun</span> : <span class="id">var</span> -&gt; <span class="id">expr</span> -&gt; <span class="id">val</span><br/>
&nbsp;&nbsp;| <span class="id">vfix</span> : <span class="id">var</span> -&gt; <span class="id">var</span> -&gt; <span class="id">expr</span> -&gt; <span class="id">val</span><br/>
&nbsp;&nbsp;| <span class="id">vloc</span> : <span class="id">loc</span> -&gt; <span class="id">val</span><br/>
&nbsp;&nbsp;| <span class="id">vtup</span> : <span class="id">val</span> -&gt; <span class="id">val</span> -&gt; <span class="id">val</span><br/>
&nbsp;&nbsp;| <span class="id">vstr</span> : <span class="id">string</span> -&gt; <span class="id">val</span><br/>
&nbsp;&nbsp;| <span class="id">vbool</span> : <span class="id">bool</span> -&gt; <span class="id">val</span><br/>
&nbsp;&nbsp;| <span class="id">vlist</span> : <span class="id">list</span> <span class="id">val</span> -&gt; <span class="id">val</span><br/>
<br/>
<span class="kwd">with</span> <span class="id">event</span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id">ev</span> (<span class="id">s</span>:<span class="id">var</span>) (<span class="id">v</span>:<span class="id">val</span>) | <span class="id">any</span><br/>
<br/>
<span class="kwd">with</span> <span class="id">theta</span> :=<br/>
&nbsp;&nbsp;| <span class="id">bot</span> : <span class="id">theta</span><br/>
&nbsp;&nbsp;| <span class="id">emp</span> : <span class="id">theta</span><br/>
&nbsp;&nbsp;| <span class="id">theta_singleton</span> : <span class="id">event</span> -&gt; <span class="id">theta</span><br/>
&nbsp;&nbsp;| <span class="id">seq</span> : <span class="id">theta</span> -&gt; <span class="id">theta</span> -&gt; <span class="id">theta</span><br/>
&nbsp;&nbsp;| <span class="id">disj</span> : <span class="id">theta</span> -&gt; <span class="id">theta</span> -&gt; <span class="id">theta</span><br/>
&nbsp;&nbsp;| <span class="id">kleene</span> : <span class="id">theta</span> -&gt; <span class="id">theta</span><br/>
<br/>
<span class="kwd">with</span> <span class="id">futureCond</span> :=<br/>
&nbsp;&nbsp;| <span class="id">fc_singleton</span> : <span class="id">theta</span> -&gt; <span class="id">futureCond</span><br/>
&nbsp;&nbsp;| <span class="id">fc_conj</span> : <span class="id">futureCond</span> -&gt; <span class="id">futureCond</span> -&gt; <span class="id">futureCond</span><br/>
<br/>
<span class="kwd">with</span> <span class="id">expr</span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id">pvar</span> (<span class="id">x</span>: <span class="id">var</span>)<br/>
&nbsp;&nbsp;| <span class="id">pval</span> (<span class="id">v</span>: <span class="id">val</span>)<br/>
&nbsp;&nbsp;| <span class="id">pevent</span>  (<span class="id">ev</span>:<span class="id">event</span>)<br/>
&nbsp;&nbsp;| <span class="id">pif</span> (<span class="id">b</span>: <span class="id">expr</span>) (<span class="id">e1</span>: <span class="id">expr</span>) (<span class="id">e2</span>: <span class="id">expr</span>)<br/>
&nbsp;&nbsp;| <span class="id">passign</span> (<span class="id">x</span>: <span class="id">expr</span>) (<span class="id">v</span>: <span class="id">expr</span>)<br/>
&nbsp;&nbsp;| <span class="id">passume</span> (<span class="id">f</span>:<span class="id">futureCond</span>)<br/>
&nbsp;&nbsp;| <span class="id">papp</span> (<span class="id">f</span>: <span class="id">expr</span>) (<span class="id">e</span>: <span class="id">expr</span>)<br/>
&nbsp;&nbsp;| <span class="id">pseq</span> (<span class="id">e1</span>:<span class="id">expr</span>) (<span class="id">e2</span>:<span class="id">expr</span>)<br/>
&nbsp;&nbsp;| <span class="id">plet</span> (<span class="id">x</span>: <span class="id">var</span>) (<span class="id">e1</span> <span class="id">e2</span>: <span class="id">expr</span>)<br/>
&nbsp;&nbsp;| <span class="id">pref</span> (<span class="id">v</span>: <span class="id">expr</span>)<br/>
&nbsp;&nbsp;| <span class="id">pderef</span> (<span class="id">v</span>: <span class="id">expr</span>)<br/>
&nbsp;&nbsp;| <span class="id">pfree</span> (<span class="id">e</span>:<span class="id">expr</span>)<br/>
&nbsp;&nbsp;| <span class="id">popen</span> (<span class="id">x</span>: <span class="id">val</span>)<br/>
&nbsp;&nbsp;| <span class="id">pclose</span> (<span class="id">e</span>:<span class="id">expr</span>)<br/>
&nbsp;&nbsp;.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">trace_default</span> := (<span class="id">kleene</span> (<span class="id">theta_singleton</span> <span class="id">any</span>)).<br/>
<span class="kwd">Definition</span> <span class="id">fc_default</span> := <span class="id">fc_singleton</span>(<span class="id">kleene</span> (<span class="id">theta_singleton</span> <span class="id">any</span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">trace_finally</span> <span class="id">ev</span> := (<span class="id">seq</span> <span class="id">trace_default</span> (<span class="id">theta_singleton</span> <span class="id">ev</span>)).<br/>
<span class="kwd">Definition</span> <span class="id">fc_finally</span> <span class="id">ev</span> := <span class="id">fc_singleton</span> (<span class="id">trace_finally</span> <span class="id">ev</span>).<br/>
<br/>
#[<span class="id">global</span>]<br/>
<span class="kwd">Instance</span> <span class="id">Inhab_val</span> : <span class="id">Inhab</span> <span class="id">val</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">vunit</span>).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Module</span> <span class="id">Val</span>.<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id">value</span> := <span class="id">val</span>.<br/>
<span class="kwd">End</span> <span class="id">Val</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">rho</span> : <span class="kwd">Type</span> := <span class="id">list</span> (<span class="id">event</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">fstEvs</span> : <span class="kwd">Type</span> := <span class="id">list</span> (<span class="id">event</span>).<br/>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">subst</span> (<span class="id">y</span>:<span class="id">var</span>) (<span class="id">w</span>:<span class="id">val</span>) (<span class="id">e</span>:<span class="id">expr</span>) : <span class="id">expr</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">aux</span> <span class="id">t</span> := <span class="id">subst</span> <span class="id">y</span> <span class="id">w</span> <span class="id">t</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">if_y_eq</span> <span class="id">x</span> <span class="id">t1</span> <span class="id">t2</span> := <span class="kwd">if</span> <span class="id">var_eq</span> <span class="id">x</span> <span class="id">y</span> <span class="kwd">then</span> <span class="id">t1</span> <span class="kwd">else</span> <span class="id">t2</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">e</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">pval</span> <span class="id">v</span> =&gt; <span class="id">pval</span> <span class="id">v</span><br/>
&nbsp;&nbsp;| <span class="id">pvar</span> <span class="id">x</span> =&gt; <span class="id">if_y_eq</span> <span class="id">x</span> (<span class="id">pval</span> <span class="id">w</span>) <span class="id">e</span><br/>
&nbsp;&nbsp;| <span class="id">papp</span> <span class="id">t1</span> <span class="id">t2</span> =&gt; <span class="id">papp</span> (<span class="id">aux</span> <span class="id">t1</span>) (<span class="id">aux</span> <span class="id">t2</span>)<br/>
&nbsp;&nbsp;| <span class="id">plet</span> <span class="id">x</span> <span class="id">t1</span> <span class="id">t2</span> =&gt; <span class="id">plet</span> <span class="id">x</span> (<span class="id">aux</span> <span class="id">t1</span>) (<span class="id">if_y_eq</span> <span class="id">x</span> <span class="id">t2</span> (<span class="id">aux</span> <span class="id">t2</span>))<br/>
&nbsp;&nbsp;| <span class="id">pif</span> <span class="id">t0</span> <span class="id">t1</span> <span class="id">t2</span> =&gt; <span class="id">pif</span> (<span class="id">aux</span> <span class="id">t0</span>) (<span class="id">aux</span> <span class="id">t1</span>) (<span class="id">aux</span> <span class="id">t2</span>)<br/>
&nbsp;&nbsp;| <span class="id">pevent</span> _ =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;| <span class="id">passume</span> _ =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;| <span class="id">pderef</span> <span class="id">t1</span> =&gt; <span class="id">pderef</span> (<span class="id">aux</span> <span class="id">t1</span>)<br/>
&nbsp;&nbsp;| <span class="id">passign</span> <span class="id">t1</span> <span class="id">t2</span> =&gt;  <span class="id">passign</span> (<span class="id">aux</span> <span class="id">t1</span>) (<span class="id">aux</span> <span class="id">t2</span>)<br/>
&nbsp;&nbsp;| <span class="id">pseq</span> <span class="id">t1</span> <span class="id">t2</span> =&gt;  <span class="id">pseq</span> (<span class="id">aux</span> <span class="id">t1</span>) (<span class="id">aux</span> <span class="id">t2</span>)<br/>
&nbsp;&nbsp;| <span class="id">pref</span> <span class="id">t1</span> =&gt; <span class="id">pref</span> (<span class="id">aux</span> <span class="id">t1</span>)<br/>
&nbsp;&nbsp;| <span class="id">pfree</span> <span class="id">t1</span> =&gt; <span class="id">pfree</span> (<span class="id">aux</span> <span class="id">t1</span>)<br/>
&nbsp;&nbsp;| <span class="id">popen</span> <span class="id">x</span> =&gt; <span class="id">e</span><br/>
&nbsp;&nbsp;| <span class="id">pclose</span> <span class="id">t1</span> =&gt; <span class="id">pclose</span> (<span class="id">aux</span> <span class="id">t1</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">SLF's heap theory as a functor. </div>
<span class="kwd">Module</span> <span class="kwd">Export</span> <span class="id">Heap</span> := <span class="id">HeapF.HeapSetup</span> <span class="id">Val</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">empty_heap</span> : <span class="id">heap</span> := <span class="id">Fmap.empty</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">precond</span> := <span class="id">hprop</span>.<br/>
<span class="kwd">Definition</span> <span class="id">postcond</span> := <span class="id">val</span> -&gt; <span class="id">hprop</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">trace_model</span> : <span class="id">rho</span> -&gt; <span class="id">theta</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">tm_emp</span> : <span class="id">trace_model</span> <span class="id">nil</span> <span class="id">emp</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">tm_singleton</span> : <span class="kwd">forall</span> <span class="id">ev1</span> <span class="id">ev</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ev</span> = <span class="id">ev1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> (<span class="id">ev1</span>::<span class="id">nil</span>) (<span class="id">theta_singleton</span> <span class="id">ev</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">tm_seq</span> : <span class="kwd">forall</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho1</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho2</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> (<span class="id">rho1</span> ++ <span class="id">rho2</span>) (<span class="id">seq</span> <span class="id">t1</span> <span class="id">t2</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">tm_disj_left</span> : <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> (<span class="id">disj</span> <span class="id">t1</span> <span class="id">t2</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">tm_disj_right</span> : <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> (<span class="id">disj</span> <span class="id">t1</span> <span class="id">t2</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">tm_kleene_emp</span> : <span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">nil</span> (<span class="id">kleene</span> <span class="id">t</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">tm_kleene_rec</span> : <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> (<span class="id">seq</span> <span class="id">t</span> (<span class="id">kleene</span> <span class="id">t</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> (<span class="id">kleene</span> <span class="id">t</span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">fc_model</span> : <span class="id">rho</span> -&gt; <span class="id">futureCond</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">fc_model_singleton</span> : <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> (<span class="id">fc_singleton</span> <span class="id">t</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">fc_model_conj</span> : <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">f1</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> <span class="id">f1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">nullable</span>: <span class="id">theta</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">nullable_emp</span> : <span class="id">nullable</span> <span class="id">emp</span><br/>
&nbsp;&nbsp;| <span class="id">nullable_seq</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nullable</span> <span class="id">t1</span> -&gt; <span class="id">nullable</span> <span class="id">t2</span> -&gt; <span class="id">nullable</span> (<span class="id">seq</span> <span class="id">t1</span> <span class="id">t2</span>)<br/>
&nbsp;&nbsp;| <span class="id">nullable_disj_left</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nullable</span> <span class="id">t1</span> -&gt; <span class="id">nullable</span> (<span class="id">disj</span> <span class="id">t1</span> <span class="id">t2</span>)<br/>
&nbsp;&nbsp;| <span class="id">nullable_disj_right</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nullable</span> <span class="id">t2</span> -&gt; <span class="id">nullable</span> (<span class="id">disj</span> <span class="id">t1</span> <span class="id">t2</span>)<br/>
&nbsp;&nbsp;| <span class="id">nullable_kleene</span> : <span class="kwd">forall</span> <span class="id">t</span>, <span class="id">nullable</span> (<span class="id">kleene</span> <span class="id">t</span>) .<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">empty_rho_model_nullable_trace</span> : <span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id">nullable</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">nil</span> <span class="id">t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">proof</span> <span class="id">List.app_nil_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">event</span> <span class="id">nil</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHnullable1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHnullable2</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">tm_disj_left</span>. <span class="id">exact</span> <span class="id">IHnullable</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">tm_disj_right</span>. <span class="id">exact</span> <span class="id">IHnullable</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">tm_kleene_emp</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">trace_model_emp_must_nil</span> : <span class="kwd">forall</span> <span class="id">rho</span>,<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">emp</span> -&gt; <span class="id">rho</span> = <span class="id">nil</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">fst</span> : <span class="id">theta</span> -&gt; <span class="id">fstEvs</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">fst_bot</span>: <span class="id">fst</span> <span class="id">bot</span> <span class="id">nil</span><br/>
&nbsp;&nbsp;| <span class="id">fst_emp</span>: <span class="id">fst</span> <span class="id">emp</span> <span class="id">nil</span><br/>
&nbsp;&nbsp;| <span class="id">fst_event</span>: <span class="kwd">forall</span> <span class="id">e</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> (<span class="id">theta_singleton</span> (<span class="id">ev</span> <span class="id">e</span> <span class="id">v</span>)) ((<span class="id">ev</span> <span class="id">e</span> <span class="id">v</span>) :: <span class="id">nil</span>)<br/>
&nbsp;&nbsp;| <span class="id">fst_seq_nullable</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">fst1</span> <span class="id">fst2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nullable</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> <span class="id">t1</span> <span class="id">fst1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> <span class="id">t2</span> <span class="id">fst2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> (<span class="id">seq</span> <span class="id">t1</span> <span class="id">t2</span>) (<span class="id">fst1</span> ++ <span class="id">fst2</span>)<br/>
&nbsp;&nbsp;| <span class="id">fst_seq_not_nullable</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">fst1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> <span class="id">t1</span> <span class="id">fst1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> (<span class="id">seq</span> <span class="id">t1</span> <span class="id">t2</span>) (<span class="id">fst1</span>)<br/>
&nbsp;&nbsp;| <span class="id">fst_disj</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">fst1</span> <span class="id">fst2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> <span class="id">t1</span> <span class="id">fst1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> <span class="id">t2</span> <span class="id">fst2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> (<span class="id">disj</span> <span class="id">t1</span> <span class="id">t2</span>) (<span class="id">fst1</span> ++ <span class="id">fst2</span>)<br/>
&nbsp;&nbsp;| <span class="id">fst_kleene</span> : <span class="kwd">forall</span> <span class="id">t</span> <span class="id">f1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> <span class="id">t</span> <span class="id">f1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fst</span> (<span class="id">kleene</span> <span class="id">t</span>) <span class="id">f1</span><br/>
&nbsp;&nbsp;.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">theta_der</span> : <span class="id">theta</span> -&gt; <span class="id">event</span> -&gt; <span class="id">theta</span>  -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">derivative_bot</span> : <span class="kwd">forall</span> <span class="id">ev</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">bot</span> <span class="id">ev</span> <span class="id">bot</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">derivative_emp</span> : <span class="kwd">forall</span> <span class="id">ev</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">emp</span> <span class="id">ev</span> <span class="id">bot</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">derivative_event_singleton</span> : <span class="kwd">forall</span> <span class="id">ev1</span> <span class="id">ev2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ev1</span> = <span class="id">ev2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> (<span class="id">theta_singleton</span> <span class="id">ev1</span>) <span class="id">ev2</span> <span class="id">emp</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">derivative_event_singleton_bot</span> : <span class="kwd">forall</span> <span class="id">ev1</span> <span class="id">ev2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ev1</span> &lt;&gt; <span class="id">ev2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> (<span class="id">theta_singleton</span> <span class="id">ev1</span>) <span class="id">ev2</span> <span class="id">bot</span><br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">derivative_seq_nullable</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">ev</span> <span class="id">t1_der</span> <span class="id">t2_der</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nullable</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t1</span> <span class="id">ev</span> <span class="id">t1_der</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t2</span> <span class="id">ev</span> <span class="id">t2_der</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> (<span class="id">seq</span> <span class="id">t1</span> <span class="id">t2</span>) <span class="id">ev</span> (<span class="id">disj</span> (<span class="id">seq</span> <span class="id">t1_der</span> <span class="id">t2</span>) <span class="id">t2_der</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">derivative_seq_not_nullable</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">ev</span> <span class="id">t1_der</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t1</span> <span class="id">ev</span> <span class="id">t1_der</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> (<span class="id">seq</span> <span class="id">t1</span> <span class="id">t2</span>) <span class="id">ev</span> (<span class="id">seq</span> <span class="id">t1_der</span> <span class="id">t2</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">derivative_disj</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">ev</span> <span class="id">t1_der</span> <span class="id">t2_der</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t1</span> <span class="id">ev</span> <span class="id">t1_der</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t2</span> <span class="id">ev</span> <span class="id">t2_der</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> (<span class="id">disj</span> <span class="id">t1</span> <span class="id">t2</span>) <span class="id">ev</span> (<span class="id">disj</span> <span class="id">t1_der</span> <span class="id">t2_der</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">derivative_kleene</span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">ev</span> <span class="id">t_der</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t</span> <span class="id">ev</span> <span class="id">t_der</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> (<span class="id">kleene</span> <span class="id">t</span>) <span class="id">ev</span> (<span class="id">seq</span> (<span class="id">t_der</span>) (<span class="id">kleene</span> <span class="id">t</span>))<br/>
&nbsp;&nbsp;.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">fc_der</span> : <span class="id">futureCond</span> -&gt; <span class="id">event</span> -&gt; <span class="id">futureCond</span>  -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">derivative_theta</span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">ev</span> <span class="id">t1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t</span> <span class="id">ev</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_der</span> (<span class="id">fc_singleton</span> <span class="id">t</span> ) <span class="id">ev</span> (<span class="id">fc_singleton</span> <span class="id">t1</span> )<br/>
<br/>
&nbsp;&nbsp;| <span class="id">derivative_fc_conj</span>: <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">ev</span> <span class="id">f_der1</span> <span class="id">f_der2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_der</span> <span class="id">f1</span> <span class="id">ev</span> <span class="id">f_der1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_der</span> <span class="id">f2</span> <span class="id">ev</span> <span class="id">f_der2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_der</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">ev</span> (<span class="id">fc_conj</span> <span class="id">f_der1</span> <span class="id">f_der2</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">fc_model_rev</span>: <span class="kwd">forall</span>  <span class="id">f</span> <span class="id">ev0</span> <span class="id">f_der</span> <span class="id">rho0'</span>,<br/>
&nbsp;&nbsp;<span class="id">fc_der</span> <span class="id">f</span> <span class="id">ev0</span> <span class="id">f_der</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho0'</span> <span class="id">f_der</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> (<span class="id">ev0</span> :: <span class="id">rho0'</span>) <span class="id">f</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">nullable_trans</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;<span class="id">nullable</span> <span class="id">t1</span> -&gt; <span class="id">nullable</span> <span class="id">t2</span> -&gt; <span class="id">nullable</span> (<span class="id">seq</span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">normal_emp</span> : <span class="kwd">forall</span> <span class="id">t</span>, <span class="id">seq</span> <span class="id">emp</span> <span class="id">t</span> = <span class="id">t</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">disj_not_bot</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;<span class="id">disj</span> <span class="id">t1</span> <span class="id">t2</span> &lt;&gt; <span class="id">bot</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">t1</span> &lt;&gt; <span class="id">bot</span> /\ <span class="id">t1</span>=<span class="id">bot</span>) \/<br/>
&nbsp;&nbsp;(<span class="id">t2</span> &lt;&gt; <span class="id">bot</span> /\ <span class="id">t2</span>=<span class="id">bot</span>) \/<br/>
&nbsp;&nbsp;(<span class="id">t1</span> &lt;&gt; <span class="id">bot</span> /\ <span class="id">t2</span> &lt;&gt; <span class="id">bot</span>) .<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">seq_not_bot</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;<span class="id">seq</span> <span class="id">t1</span> <span class="id">t2</span> &lt;&gt; <span class="id">bot</span> -&gt; <span class="id">t1</span> &lt;&gt; <span class="id">bot</span> /\ <span class="id">t2</span> &lt;&gt; <span class="id">bot</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">fc_conj_not_bot</span>: <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span> &lt;&gt; <span class="id">fc_singleton</span> <span class="id">bot</span> -&gt; <span class="id">f1</span> &lt;&gt; <span class="id">fc_singleton</span> <span class="id">bot</span> /\ <span class="id">f2</span> &lt;&gt; <span class="id">fc_singleton</span> <span class="id">bot</span>.<br/>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">seq_not_bot_rev</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;<span class="id">t1</span> &lt;&gt; <span class="id">bot</span> /\ <span class="id">t2</span> &lt;&gt; <span class="id">bot</span> -&gt; <span class="id">seq</span> <span class="id">t1</span> <span class="id">t2</span> &lt;&gt; <span class="id">bot</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">disj_not_bot_rev</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;<span class="id">t1</span> &lt;&gt; <span class="id">bot</span> /\ <span class="id">t2</span> &lt;&gt; <span class="id">bot</span> -&gt; <span class="id">disj</span> <span class="id">t1</span> <span class="id">t2</span> &lt;&gt; <span class="id">bot</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">theta_singleton_is_not_bot</span>: <span class="kwd">forall</span> <span class="id">ev</span>,<br/>
&nbsp;&nbsp;<span class="id">theta_singleton</span> <span class="id">ev</span> &lt;&gt; <span class="id">bot</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">kleene_not_bot</span> : <span class="kwd">forall</span> <span class="id">t</span> <span class="id">rho</span>,<br/>
&nbsp;&nbsp;<span class="id">t</span> &lt;&gt; <span class="id">bot</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> (<span class="id">kleene</span> <span class="id">t</span>) -&gt; <span class="id">rho</span> &lt;&gt; <span class="id">nil</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">case_spliting_helper</span>: <span class="kwd">forall</span> (<span class="id">ev1</span>:<span class="id">event</span>) (<span class="id">ev2</span>:<span class="id">event</span>),<br/>
&nbsp;&nbsp;<span class="id">ev1</span> = <span class="id">ev2</span> \/ <span class="id">ev1</span> &lt;&gt; <span class="id">ev2</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">case_spliting_helper_bot</span>: <span class="kwd">forall</span> (<span class="id">t</span>:<span class="id">theta</span>) ,<br/>
&nbsp;&nbsp;<span class="id">t</span> = <span class="id">bot</span> \/ <span class="id">t</span> &lt;&gt; <span class="id">bot</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">futureCond_distr</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">fc_conj</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">f3</span> =<br/>
&nbsp;&nbsp;<span class="id">fc_conj</span> <span class="id">f2</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f3</span>).<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">futureCond_distr1</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">fc_conj</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">f3</span> =<br/>
&nbsp;&nbsp;<span class="id">fc_conj</span> <span class="id">f1</span> (<span class="id">fc_conj</span> <span class="id">f2</span> <span class="id">f3</span>).<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">futureCond_distr2</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">fc_conj</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">f3</span> =<br/>
&nbsp;&nbsp;<span class="id">fc_conj</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f3</span>) (<span class="id">fc_conj</span> <span class="id">f2</span> <span class="id">f3</span>).<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">futureCond_excahnge</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span>, <span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span> = <span class="id">fc_conj</span> <span class="id">f2</span> <span class="id">f1</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">f_conj_kleene_any_is_f</span> : <span class="kwd">forall</span> <span class="id">f</span>, <span class="id">fc_conj</span> (<span class="id">fc_default</span>) <span class="id">f</span> = <span class="id">f</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">fc_comm</span>: <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span>, <span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span> = <span class="id">fc_conj</span> <span class="id">f2</span> <span class="id">f1</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">fc_exact</span>: <span class="kwd">forall</span> <span class="id">f</span>, <span class="id">fc_conj</span> <span class="id">f</span> <span class="id">f</span> = <span class="id">f</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">fc_assio</span>: <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span>, <span class="id">fc_conj</span> <span class="id">f1</span> (<span class="id">fc_conj</span> <span class="id">f2</span> <span class="id">f3</span>) = <span class="id">fc_conj</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">f3</span>.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">nullable_rev</span> : <span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id">nullable</span> <span class="id">t</span> -&gt; <span class="id">trace_model</span> <span class="id">nil</span> <span class="id">t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span>&lt;-(<span class="id">List.app_nil_r</span> <span class="id">nil</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">exact</span>  <span class="id">IHnullable1</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHnullable2</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">tm_disj_left</span>. <span class="id">exact</span> <span class="id">IHnullable</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">tm_disj_right</span>. <span class="id">exact</span> <span class="id">IHnullable</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">tm_kleene_emp</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">theta_der_not_bot</span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">ev</span> <span class="id">t_der</span>,<br/>
&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t</span> <span class="id">ev</span> <span class="id">t_der</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">t_der</span> &lt;&gt; <span class="id">bot</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">t</span> &lt;&gt; <span class="id">bot</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">false</span>.<br/>
&nbsp;&nbsp;- <span class="id">false</span>.<br/>
&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">proof</span> (<span class="id">theta_singleton_is_not_bot</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> (<span class="id">H1</span> <span class="id">ev1</span>).<br/>
&nbsp;&nbsp;- <span class="id">false</span>.<br/>
&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">disj_not_bot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">o</span> (<span class="id">seq</span> <span class="id">t1_der</span> <span class="id">t2</span>) <span class="id">t2_der</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invert</span> <span class="id">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">false</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">false</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">seq_not_bot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">a</span> <span class="id">t1_der</span> <span class="id">t2</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destr</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der1</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">seq_not_bot_rev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">n</span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">IHtheta_der1</span>. <span class="id">exact</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;- <span class="id">pose</span>  (<span class="id">seq_not_bot</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">a</span> <span class="id">t1_der</span> <span class="id">t2</span> <span class="id">H0</span>)  .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destr</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">seq_not_bot_rev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">n</span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">IHtheta_der</span>. <span class="id">exact</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">disj_not_bot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">o</span> <span class="id">t1_der</span> <span class="id">t2_der</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invert</span> <span class="id">o</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destr</span> <span class="id">H2</span>.  <span class="id">false</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>.  <span class="id">destr</span> <span class="id">H3</span>. <span class="id">false</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destr</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der2</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">disj_not_bot_rev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">IHtheta_der1</span>. <span class="id">exact</span> <span class="id">IHtheta_der2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">seq_not_bot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">a</span> <span class="id">t_der</span> (<span class="id">kleene</span> <span class="id">t</span>) <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destr</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H2</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">derivative_model_false</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">ev0</span>,<br/>
&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t1</span> <span class="id">ev0</span> <span class="id">bot</span> -&gt; <span class="id">false</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivative_model</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">ev0</span> <span class="id">deriv1</span> <span class="id">rho0</span>,<br/>
&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t1</span> <span class="id">ev0</span> <span class="id">deriv1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">deriv1</span> &lt;&gt; <span class="id">bot</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho0</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">rho1</span>,<br/>
&nbsp;&nbsp;<span class="id">rho0</span> = <span class="id">ev0</span> :: <span class="id">rho1</span> /\ <span class="id">trace_model</span> <span class="id">rho1</span> <span class="id">deriv1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho0</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">false</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">false</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">nil</span>:<span class="id">rho</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">false</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">disj_not_bot</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">o</span> (<span class="id">seq</span> <span class="id">t1_der</span> <span class="id">t2</span>) <span class="id">t2_der</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">o</span>. <span class="id">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">false</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H3</span>. <span class="id">destruct</span> <span class="id">H3</span>. <span class="id">false</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der2</span> <span class="id">H4</span> <span class="id">rho2</span> <span class="id">H8</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHtheta_der2</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">seq_not_bot</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">a</span> <span class="id">t1_der</span> <span class="id">t2</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der1</span> <span class="id">H5</span> <span class="id">rho1</span> <span class="id">H7</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHtheta_der1</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">rho3</span> ++ <span class="id">rho2</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">tm_disj_left</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H13</span>. <span class="id">exact</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">invert</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">seq_not_bot</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">a</span> <span class="id">t1_der</span> <span class="id">t2</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der</span> <span class="id">H1</span> <span class="id">rho1</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHtheta_der</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">rho0</span>++<span class="id">rho2</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">eauto</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H7</span>. <span class="id">exact</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">disj_not_bot</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">o</span> <span class="id">t1_der</span> <span class="id">t2_der</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">o</span>. <span class="id">destruct</span> <span class="id">H2</span>. <span class="id">false</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H2</span>. <span class="id">destruct</span> <span class="id">H2</span>. <span class="id">false</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der1</span> <span class="id">H2</span> <span class="id">rho0</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHtheta_der1</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">rho1</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">eauto</span>. <span class="id">apply</span> <span class="id">tm_disj_left</span>. <span class="id">exact</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">disj_not_bot</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">o</span> <span class="id">t1_der</span> <span class="id">t2_der</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">o</span>. <span class="id">destruct</span> <span class="id">H2</span>. <span class="id">false</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H2</span>. <span class="id">destruct</span> <span class="id">H2</span>. <span class="id">false</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der2</span> <span class="id">H3</span> <span class="id">rho0</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHtheta_der2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">rho1</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">eauto</span>. <span class="id">apply</span> <span class="id">tm_disj_right</span>. <span class="id">exact</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">seq_not_bot</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">a</span> <span class="id">t_der</span> (<span class="id">kleene</span> <span class="id">t</span>) <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">theta_der_not_bot</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">n</span> <span class="id">t</span> <span class="id">ev0</span> <span class="id">t_der</span> <span class="id">H</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">kleene_not_bot</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">n0</span> <span class="id">t</span> <span class="id">rho0</span> <span class="id">n</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>. <span class="id">false</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der</span> <span class="id">H2</span>  <span class="id">rho2</span> <span class="id">H9</span>) .<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHtheta_der</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> ( <span class="id">rho1</span> ++ <span class="id">rho3</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H4</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H5</span>. <span class="id">exact</span> <span class="id">H10</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivative_model_reverse</span>: <span class="kwd">forall</span> <span class="id">rho1</span> <span class="id">deriv2</span> <span class="id">t2</span> <span class="id">ev0</span>,<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho1</span> <span class="id">deriv2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t2</span> <span class="id">ev0</span> <span class="id">deriv2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> (<span class="id">ev0</span> :: <span class="id">rho1</span>) <span class="id">t2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho1</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der1</span> <span class="id">rho0</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">List.app_comm_cons</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">event</span> <span class="id">rho0</span> <span class="id">rho2</span> <span class="id">ev0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHtheta_der1</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der2</span> <span class="id">rho1</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(nil++&nbsp;_&nbsp;).&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">List.app_nil_l</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">event</span> (<span class="id">ev0</span> :: <span class="id">rho1</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">empty_rho_model_nullable_trace</span>. <span class="id">exact</span> <span class="id">H</span>. <span class="id">exact</span> <span class="id">IHtheta_der2</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der</span> <span class="id">rho0</span> <span class="id">H4</span> ).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">List.app_comm_cons</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">event</span> <span class="id">rho0</span> <span class="id">rho2</span> <span class="id">ev0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHtheta_der</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der1</span> <span class="id">rho1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">tm_disj_left</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHtheta_der1</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der2</span> <span class="id">rho1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">tm_disj_right</span>. <span class="id">exact</span> <span class="id">IHtheta_der2</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtheta_der</span> <span class="id">rho0</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">List.app_comm_cons</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">event</span> <span class="id">rho0</span> <span class="id">rho2</span> <span class="id">ev0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHtheta_der</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H5</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">inclusion</span> : <span class="id">theta</span> -&gt; <span class="id">theta</span> -&gt; <span class="kwd">Prop</span> :=<br/>
<br/>
&nbsp;&nbsp;| <span class="id">inc_bot</span>: <span class="kwd">forall</span> <span class="id">t</span>, <span class="id">inclusion</span> <span class="id">bot</span> <span class="id">t</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">inc_emp</span>: <span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nullable</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">emp</span> <span class="id">t</span><br/>
<br/>
&nbsp;&nbsp;| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inc_unfold</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">ev</span> <span class="id">deriv1</span> <span class="id">deriv2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t1</span> <span class="id">ev</span> <span class="id">deriv1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">deriv1</span> &lt;&gt; <span class="id">bot</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t2</span> <span class="id">ev</span> <span class="id">deriv2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">deriv1</span> <span class="id">deriv2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t1</span> <span class="id">t2</span><br/>
.<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">inclusion_sound</span>: <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">rho</span>,<br/>
&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t1</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho0</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">empty_rho_model_nullable_trace</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">t</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">trace_model_emp_must_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">rho0</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">derivative_model</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">t1</span> <span class="id">ev0</span> <span class="id">deriv1</span> <span class="id">rho0</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHinclusion</span> <span class="id">rho1</span> <span class="id">H6</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">derivative_model_reverse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">rho1</span> <span class="id">deriv2</span> <span class="id">t2</span> <span class="id">ev0</span> <span class="id">IHinclusion</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H4</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">trace_model_nil_indicate_nullable</span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">rho</span>,<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t</span> -&gt; <span class="id">rho</span> = <span class="id">nil</span> -&gt; <span class="id">nullable</span> <span class="id">t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">false</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">List.app_eq_nil</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">event</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H2</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHtrace_model1</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHtrace_model2</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHtrace_model</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">nullable_disj_right</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHtrace_model</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Axiom</span> <span class="id">inclusion_rev</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">ev1</span> <span class="id">deriv0</span> <span class="id">deriv</span>,<br/>
&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t1</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t1</span> <span class="id">ev1</span> <span class="id">deriv0</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t1</span> <span class="id">ev1</span> <span class="id">deriv0</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">deriv0</span> <span class="id">deriv</span>.<br/>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">emp_is_not_bot</span> : <span class="id">emp</span> &lt;&gt; <span class="id">bot</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">kleene_bot_is_emp</span> : <span class="id">kleene</span> <span class="id">bot</span> = <span class="id">emp</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">kleene_emp_is_bot</span> : <span class="id">kleene</span> <span class="id">emp</span> = <span class="id">bot</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">kleene_def</span> : <span class="kwd">forall</span> <span class="id">t</span>, <span class="id">kleene</span> <span class="id">t</span> = <span class="id">emp</span> \/ <span class="id">kleene</span> <span class="id">t</span> = <span class="id">seq</span> <span class="id">t</span> (<span class="id">kleene</span> <span class="id">t</span>).<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">inclusion_exact</span>: <span class="kwd">forall</span> <span class="id">t</span>, <span class="id">inclusion</span> <span class="id">t</span> <span class="id">t</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">anything_entail_default</span> : <span class="kwd">forall</span> <span class="id">t</span>, <span class="id">inclusion</span> <span class="id">t</span> ((<span class="id">trace_default</span>)).<br/>
<span class="kwd">Axiom</span> <span class="id">inclusion_bot</span>: <span class="kwd">forall</span> <span class="id">t</span>, <span class="id">inclusion</span> <span class="id">t</span> <span class="id">bot</span> -&gt; <span class="id">t</span> = <span class="id">bot</span> .<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">all_trace_have_derivative</span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">ev</span> ,<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">deriv</span>, <span class="id">theta_der</span> <span class="id">t</span> <span class="id">ev</span> <span class="id">deriv</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">bot</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">bot</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">case_spliting_helper</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">e</span> <span class="id">ev0</span>).<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">emp</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">bot</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHt1</span>.<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHt2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">seq</span> <span class="id">deriv</span> <span class="id">t2</span>).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHt1</span>.<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHt2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">disj</span> <span class="id">deriv</span> <span class="id">deriv0</span>).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHt</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">seq</span> <span class="id">deriv</span> (<span class="id">kleene</span> <span class="id">t</span>)).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">inclusion_theta_der_indicate</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">ev0</span> <span class="id">deriv1</span>,<br/>
&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t1</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t1</span> <span class="id">ev0</span> <span class="id">deriv1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">deriv2</span>,<br/>
&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t2</span> <span class="id">ev0</span> <span class="id">deriv2</span> /\ <span class="id">inclusion</span> <span class="id">deriv1</span> <span class="id">deriv2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">ev0</span> <span class="id">deriv1</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">subst</span>. <span class="id">invert</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">all_trace_have_derivative</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">t2</span> <span class="id">ev0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">deriv</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H1</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">all_trace_have_derivative</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">t2</span> <span class="id">ev0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">deriv</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H2</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">all_trace_have_derivative</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">t2</span> <span class="id">ev1</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">deriv</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">inclusion_rev</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H7</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">inclusion_trans</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span>,<br/>
&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t1</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t2</span> <span class="id">t3</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t1</span> <span class="id">t3</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">t3</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">empty_rho_model_nullable_trace</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">t</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">inclusion_sound</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">t</span> <span class="id">t3</span> <span class="id">nil</span> <span class="id">H0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">inc_emp</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(_&nbsp;++&nbsp;_&nbsp;=nil).&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">List.app_eq_nil</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">event</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">trace_model_nil_indicate_nullable</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">t1</span> <span class="id">nil</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H2</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">trace_model_nil_indicate_nullable</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">t2</span> <span class="id">nil</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H2</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">nullable_disj_left</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">trace_model_nil_indicate_nullable</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">t1</span> <span class="id">nil</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H2</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">nullable_disj_right</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">trace_model_nil_indicate_nullable</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">t2</span> <span class="id">nil</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H2</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">inclusion_theta_der_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">ev0</span> <span class="id">deriv2</span> <span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHinclusion</span> <span class="id">deriv0</span> <span class="id">H6</span> ).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">inc_unfold</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">t1</span> <span class="id">t3</span> <span class="id">ev0</span> <span class="id">deriv1</span> <span class="id">deriv0</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H5</span> <span class="id">IHinclusion</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H4</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">trace_model_prefix</span> : <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">t</span> <span class="id">rho1</span> <span class="id">t1</span>,<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho1</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> (<span class="id">rho</span>++<span class="id">rho1</span>) (<span class="id">seq</span> <span class="id">t</span> <span class="id">t1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho1</span> <span class="id">t1</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">constructor</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>. <span class="id">constructor</span>. <span class="id">constructor</span>. <span class="id">reflexivity</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>. <span class="id">specialize</span> (<span class="id">IHtrace_model1</span> <span class="id">rho0</span> <span class="id">t0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>. <span class="id">specialize</span> (<span class="id">IHtrace_model2</span> <span class="id">rho0</span> <span class="id">t0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">IHtrace_model1</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">IHtrace_model2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">eauto</span>. <span class="id">eauto</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtrace_model</span> <span class="id">rho1</span> <span class="id">t0</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">IHtrace_model</span>. <span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">tm_disj_left</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtrace_model</span> <span class="id">rho1</span> <span class="id">t0</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">IHtrace_model</span>. <span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">tm_disj_right</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtrace_model</span> <span class="id">rho1</span> <span class="id">t1</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">IHtrace_model</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>. <span class="id">rewrite</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Inductive</span> <span class="id">futureCondEntail</span> : <span class="id">futureCond</span> -&gt; <span class="id">futureCond</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">futureCondEntail_empty</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t1</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> (<span class="id">fc_singleton</span> <span class="id">t1</span>) (<span class="id">fc_singleton</span> <span class="id">t2</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureCondEntail_conj_LHS_1</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">f</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureCondEntail_conj_LHS_2</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f2</span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">f</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureCondEntail_conj_RHS</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f</span> <span class="id">f1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureCondEntail_trans</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f2</span> <span class="id">f3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f3</span><br/>
&nbsp;.<br/>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">futureCondEntail_rev</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">ev1</span> <span class="id">deriv0</span> <span class="id">deriv</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">t1</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_der</span> <span class="id">t1</span> <span class="id">ev1</span> <span class="id">deriv0</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_der</span> <span class="id">t1</span> <span class="id">ev1</span> <span class="id">deriv0</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">deriv0</span> <span class="id">deriv</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">futureCondEntail_exact</span> : <span class="kwd">forall</span> <span class="id">f</span>, <span class="id">futureCondEntail</span> <span class="id">f</span> <span class="id">f</span> .<br/>
<span class="kwd">Axiom</span> <span class="id">futureCondEntailTrueISTrue</span>: <span class="kwd">forall</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">fc_default</span> <span class="id">f</span> -&gt; <span class="id">f</span> = <span class="id">fc_default</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">futureCondEntail_indicate</span>: <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span>, <span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f3</span>, <span class="id">f1</span> = <span class="id">fc_conj</span> <span class="id">f3</span> <span class="id">f2</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">f_entail_conj_indicate</span> : <span class="kwd">forall</span> <span class="id">f3</span> <span class="id">x0</span> <span class="id">f0</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f3</span> (<span class="id">fc_conj</span> <span class="id">x0</span> <span class="id">f0</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f3</span> <span class="id">x0</span> /\ <span class="id">futureCondEntail</span> <span class="id">f3</span> <span class="id">f0</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">futureCond_sound</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">rho</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> <span class="id">f1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> <span class="id">f2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho0</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">inclusion_sound</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">rho0</span> <span class="id">H</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">specialize</span> (<span class="id">IHfutureCondEntail</span> <span class="id">rho0</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHfutureCondEntail</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">apply</span> <span class="id">IHfutureCondEntail</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail1</span> <span class="id">rho0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail2</span> <span class="id">rho0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail1</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail2</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail1</span> <span class="id">rho0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail2</span> <span class="id">rho0</span> <span class="id">IHfutureCondEntail1</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail2</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">futureCond_distribution</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span> <span class="id">f4</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f3</span> <span class="id">f4</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f3</span>) (<span class="id">fc_conj</span> <span class="id">f2</span> <span class="id">f4</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">f3</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_RHS</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_1</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_2</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail</span> <span class="id">f3</span> <span class="id">f4</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">futureCond_distr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_2</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail</span> <span class="id">f3</span> <span class="id">f4</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">futureCond_distr1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_2</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail1</span> <span class="id">f3</span> <span class="id">f4</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail2</span> <span class="id">f3</span> <span class="id">f4</span> <span class="id">H1</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">futureCond_distr2</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_RHS</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail1</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail2</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_RHS</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span>  <span class="id">futureCondEntail_trans</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span> <span class="id">H</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_2</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Theorem</span> <span class="id">strong_LHS_futureEnatil</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f3</span>) <span class="id">f2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_1</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">anything_future_entail_default</span> : <span class="kwd">forall</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f</span> (<span class="id">fc_default</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> (<span class="id">anything_entail_default</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_1</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHf1</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">fc_singleton_to_trace</span> : <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> (<span class="id">fc_singleton</span> <span class="id">t</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H2</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">fc_conj_to_trace</span> : <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">f1</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> <span class="id">f1</span> /\ <span class="id">fc_model</span> <span class="id">rho</span> <span class="id">f2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>. <span class="id">split</span>. <span class="id">exact</span> <span class="id">H3</span>. <span class="id">exact</span> <span class="id">H4</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">trace_to_fc_singleton</span> : <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> (<span class="id">fc_singleton</span> <span class="id">t</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">constructor</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">subst</span>. <span class="id">constructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>. <span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">subst</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">subst</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">tm_disj_right</span>.  <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">subst</span>. <span class="id">constructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">subst</span>. <span class="id">constructor</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">trace_model_consequent</span>: <span class="kwd">forall</span> <span class="id">rho</span> <span class="id">t1</span> <span class="id">t2</span>,<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t1</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho</span> <span class="id">t2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">inclusion_sound</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">rho0</span> <span class="id">H0</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">futureSubtraction_linear</span> : <span class="id">futureCond</span> -&gt; <span class="id">rho</span> -&gt; <span class="id">futureCond</span> -&gt; <span class="kwd">Prop</span> :=<br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_linear_conj</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span> <span class="id">f4</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f1</span> <span class="id">t</span> <span class="id">f3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f2</span> <span class="id">t</span> <span class="id">f4</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">t</span> (<span class="id">fc_conj</span> <span class="id">f3</span> <span class="id">f4</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_linear_base</span> : <span class="kwd">forall</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f</span> <span class="id">nil</span> <span class="id">f</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_linear_induc</span> : <span class="kwd">forall</span> <span class="id">ev</span> <span class="id">f</span> <span class="id">f_der</span> <span class="id">t</span> <span class="id">t_der</span> <span class="id">res</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_der</span> <span class="id">f</span> <span class="id">ev</span> <span class="id">f_der</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_der</span> &lt;&gt; (<span class="id">fc_singleton</span> <span class="id">bot</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">t</span> = <span class="id">ev</span> :: <span class="id">t_der</span>  -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f_der</span> <span class="id">t_der</span> <span class="id">res</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f</span> <span class="id">t</span> <span class="id">res</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">futureSubtraction</span> : <span class="id">futureCond</span> -&gt; <span class="id">theta</span> -&gt; <span class="id">futureCond</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_bot</span>: <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f1</span> <span class="id">bot</span> <span class="id">f2</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_conj</span> : <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span> <span class="id">f4</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f1</span> <span class="id">t</span> <span class="id">f3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f2</span> <span class="id">t</span> <span class="id">f4</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">t</span> (<span class="id">fc_conj</span> <span class="id">f3</span> <span class="id">f4</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_base</span> : <span class="kwd">forall</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> (<span class="id">fc_singleton</span> <span class="id">t</span>) <span class="id">emp</span> (<span class="id">fc_singleton</span> <span class="id">t</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_induc</span> : <span class="kwd">forall</span> <span class="id">ev</span> <span class="id">f</span> <span class="id">f_der</span> <span class="id">t</span> <span class="id">t_der</span> <span class="id">res</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fc_der</span> <span class="id">f</span> <span class="id">ev</span> <span class="id">f_der</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_der</span> &lt;&gt; (<span class="id">fc_singleton</span> <span class="id">bot</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">theta_der</span> <span class="id">t</span> <span class="id">ev</span> <span class="id">t_der</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f_der</span> <span class="id">t_der</span> <span class="id">res</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f</span> <span class="id">t</span> <span class="id">res</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_strengthing_res</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">t</span> <span class="id">f1</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f</span> <span class="id">t</span> <span class="id">f1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f2</span> <span class="id">f1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f</span> <span class="id">t</span> <span class="id">f2</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_weakening_f</span>:<span class="kwd">forall</span> <span class="id">f1</span> <span class="id">t</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f1</span> <span class="id">t</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f3</span> <span class="id">t</span> <span class="id">f2</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">futureSubtraction_strengthing_t</span>: <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">t</span> <span class="id">t'</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f1</span> <span class="id">t</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t'</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f1</span> <span class="id">t'</span> <span class="id">f2</span><br/>
&nbsp;&nbsp;.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id">concate_trace_fc</span> (<span class="id">t</span>:<span class="id">theta</span>) (<span class="id">f</span>:<span class="id">futureCond</span>)  : <span class="id">futureCond</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">f</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">fc_singleton</span> <span class="id">t1</span> =&gt; <span class="id">fc_singleton</span> (<span class="id">seq</span> <span class="id">t</span> <span class="id">t1</span>)<br/>
&nbsp;&nbsp;| <span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span> =&gt; <span class="id">fc_conj</span> (<span class="id">concate_trace_fc</span> <span class="id">t</span> <span class="id">f1</span>) (<span class="id">concate_trace_fc</span> <span class="id">t</span> <span class="id">f2</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">concate_trace_fc_bot</span>: <span class="kwd">forall</span> <span class="id">f</span>, <span class="id">concate_trace_fc</span> <span class="id">bot</span> <span class="id">f</span> = <span class="id">fc_singleton</span> <span class="id">bot</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">concate_trace_fc_emp</span>: <span class="kwd">forall</span> <span class="id">f</span>, <span class="id">concate_trace_fc</span> <span class="id">emp</span> <span class="id">f</span> = <span class="id">f</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">concate_trace_fc_ev</span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">res</span> <span class="id">rho0</span> <span class="id">ev0</span> <span class="id">t_der</span>,<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho0</span> (<span class="id">concate_trace_fc</span> <span class="id">t</span> <span class="id">res</span>) -&gt; <span class="id">theta_der</span> <span class="id">t</span> <span class="id">ev0</span> <span class="id">t_der</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">rho0'</span>, <span class="id">fc_model</span> <span class="id">rho0'</span> (<span class="id">concate_trace_fc</span> <span class="id">t_der</span> <span class="id">res</span>) /\ <span class="id">rho0</span> = <span class="id">ev0</span> :: <span class="id">rho0'</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">concate_trace_fc_model</span>: <span class="kwd">forall</span> <span class="id">f2</span> <span class="id">f1</span> <span class="id">rho0</span> <span class="id">t</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f2</span> <span class="id">f1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho0</span> (<span class="id">concate_trace_fc</span> <span class="id">t</span> <span class="id">f2</span>) -&gt; <span class="id">fc_model</span> <span class="id">rho0</span> (<span class="id">concate_trace_fc</span> <span class="id">t</span> <span class="id">f1</span>).<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">concate_trace_inclusion_sound</span>: <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">rho0</span> <span class="id">t</span> <span class="id">t'</span>,<br/>
&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t'</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho0</span> (<span class="id">concate_trace_fc</span> <span class="id">t'</span> <span class="id">f1</span>) -&gt; <span class="id">fc_model</span> <span class="id">rho0</span> (<span class="id">concate_trace_fc</span> <span class="id">t</span> <span class="id">f1</span>).<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">futureSubtraction_sound</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">f'</span> <span class="id">t</span> <span class="id">rho</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f</span> <span class="id">t</span> <span class="id">f'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> (<span class="id">concate_trace_fc</span> <span class="id">t</span> <span class="id">f'</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho</span> <span class="id">f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho0</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span>  <span class="id">concate_trace_fc_bot</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.  <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">concate_trace_fc</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id">concate_trace_fc</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction1</span> <span class="id">rho0</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction2</span> <span class="id">rho0</span> <span class="id">H6</span>).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureSubtraction1</span>. <span class="id">exact</span> <span class="id">IHfutureSubtraction2</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span>  <span class="id">concate_trace_fc_emp</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">concate_trace_fc_ev</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">t</span> <span class="id">res</span> <span class="id">rho0</span> <span class="id">ev0</span> <span class="id">t_der</span> <span class="id">H3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction</span> <span class="id">rho0'</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">fc_model_rev</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">f</span> <span class="id">ev0</span> <span class="id">f_der</span> <span class="id">rho0'</span> <span class="id">H</span> <span class="id">IHfutureSubtraction</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span>  <span class="id">concate_trace_fc_model</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">f2</span> <span class="id">f1</span> <span class="id">rho0</span> <span class="id">t</span> <span class="id">H0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction</span> <span class="id">rho0</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureSubtraction</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction</span> <span class="id">rho0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureCond_sound</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">f1</span> <span class="id">f3</span> <span class="id">rho0</span> <span class="id">H0</span> <span class="id">IHfutureSubtraction</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">concate_trace_inclusion_sound</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> ( <span class="id">H2</span> <span class="id">f2</span> <span class="id">rho0</span> <span class="id">t</span> <span class="id">t'</span> <span class="id">H0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction</span> <span class="id">rho0</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureSubtraction</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">subtractFromTrueISTrue</span>: <span class="kwd">forall</span> <span class="id">ev</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">fc_default</span><br/>
(<span class="id">theta_singleton</span> <span class="id">ev</span>) <span class="id">f</span> -&gt; <span class="id">f</span> = <span class="id">fc_default</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">subtract_linear_FromTrueISTrue</span>: <span class="kwd">forall</span> <span class="id">ev</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">fc_default</span><br/>
(<span class="id">ev</span>::<span class="id">nil</span>) <span class="id">f</span> -&gt; <span class="id">f</span> = <span class="id">fc_default</span>.<br/>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">all_future_condition_has_futureSubtraction_linear</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">rho</span>,<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f'</span>, <span class="id">futureSubtraction_linear</span> <span class="id">f</span> <span class="id">rho</span> <span class="id">f'</span>.<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">futureCondEntail_fc_model_indicate</span> : <span class="kwd">forall</span> <span class="id">f2</span> <span class="id">f1</span> <span class="id">t</span> <span class="id">rho0</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f2</span> <span class="id">f1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho0</span> (<span class="id">concate_trace_fc</span> <span class="id">t</span> <span class="id">f2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">fc_model</span> <span class="id">rho0</span> (<span class="id">concate_trace_fc</span> <span class="id">t</span> <span class="id">f1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho0</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">concate_trace_fc</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id">concate_trace_fc</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">concate_trace_fc</span>. <span class="id">fold</span> <span class="id">concate_trace_fc</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H4</span>.  <span class="id">pose</span> <span class="id">proof</span> <span class="id">inclusion_sound</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">rho2</span> <span class="id">H</span> <span class="id">H5</span>). <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">concate_trace_fc</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id">concate_trace_fc</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail</span> <span class="id">rho0</span> <span class="id">t</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">concate_trace_fc</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id">concate_trace_fc</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail</span> <span class="id">rho0</span> <span class="id">t</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail1</span> <span class="id">rho0</span> <span class="id">t</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail2</span> <span class="id">rho0</span> <span class="id">t</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">concate_trace_fc</span>. <span class="id">fold</span> <span class="id">concate_trace_fc</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail1</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail2</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail1</span> <span class="id">rho0</span> <span class="id">t</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureCondEntail2</span> <span class="id">rho0</span> <span class="id">t</span> <span class="id">IHfutureCondEntail1</span>).<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">concate_trace_fc</span>. <span class="id">fold</span> <span class="id">concate_trace_fc</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">IHfutureCondEntail2</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">bigstep</span> : <span class="id">heap</span> -&gt; <span class="id">rho</span> -&gt; <span class="id">futureCond</span> -&gt; <span class="id">expr</span> -&gt; <span class="id">heap</span> -&gt; <span class="id">rho</span> -&gt; <span class="id">futureCond</span> -&gt; <span class="id">val</span> -&gt; <span class="kwd">Prop</span> :=<br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_plet</span> : <span class="kwd">forall</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">v</span> <span class="id">r</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">rho3</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f1</span> <span class="id">e1</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f2</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f2</span> (<span class="id">subst</span> <span class="id">x</span> <span class="id">v</span> <span class="id">e2</span>) <span class="id">h3</span> <span class="id">rho3</span> <span class="id">f3</span> <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f1</span> (<span class="id">plet</span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span>) <span class="id">h3</span> <span class="id">rho3</span> <span class="id">f3</span> <span class="id">r</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_const</span> : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> (<span class="id">pval</span> <span class="id">v</span>) <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">v</span><br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_if_true</span> : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">h'</span> <span class="id">r'</span> <span class="id">f'</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">e1</span> <span class="id">h'</span> <span class="id">r'</span> <span class="id">f'</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> (<span class="id">pif</span> (<span class="id">pval</span> (<span class="id">vbool</span> <span class="id">true</span>)) <span class="id">e1</span> <span class="id">e2</span>) <span class="id">h'</span> <span class="id">r'</span> <span class="id">f'</span> <span class="id">v</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_if_false</span> : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">h'</span> <span class="id">r'</span> <span class="id">f'</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">e2</span> <span class="id">h'</span> <span class="id">r'</span> <span class="id">f'</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> (<span class="id">pif</span> (<span class="id">pval</span> (<span class="id">vbool</span> <span class="id">false</span>)) <span class="id">e1</span> <span class="id">e2</span>) <span class="id">h'</span> <span class="id">r'</span> <span class="id">f'</span> <span class="id">v</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_assume</span> : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">f_assume</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> (<span class="id">passume</span> <span class="id">f_assume</span>) <span class="id">h</span> <span class="id">r</span> (<span class="id">fc_conj</span> <span class="id">f</span> <span class="id">f_assume</span>) <span class="id">vunit</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_event</span> : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">ev</span> <span class="id">f'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f</span> (<span class="id">ev</span>::<span class="id">nil</span>) <span class="id">f'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> (<span class="id">pevent</span> <span class="id">ev</span>) <span class="id">h</span> (<span class="id">r</span> ++ (<span class="id">ev</span>::<span class="id">nil</span>)) <span class="id">f'</span> <span class="id">vunit</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_pderef</span> : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">loc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Fmap.indom</span> <span class="id">h</span> <span class="id">loc</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> (<span class="id">pderef</span> (<span class="id">pval</span> (<span class="id">vloc</span> <span class="id">loc</span>))) <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> (<span class="id">Fmap.read</span> <span class="id">h</span> <span class="id">loc</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_passign</span> : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">loc</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Fmap.indom</span> <span class="id">h</span> <span class="id">loc</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> (<span class="id">passign</span> (<span class="id">pval</span> (<span class="id">vloc</span> <span class="id">loc</span>)) (<span class="id">pval</span> <span class="id">v</span>)) (<span class="id">Fmap.update</span> <span class="id">h</span> <span class="id">loc</span> <span class="id">v</span>) <span class="id">r</span> <span class="id">f</span> <span class="id">vunit</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_app</span> : <span class="kwd">forall</span> <span class="id">fromal_arg</span> <span class="id">e</span> <span class="id">actual_arg</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f1</span> (<span class="id">subst</span> <span class="id">fromal_arg</span> <span class="id">actual_arg</span> <span class="id">e</span>) <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f2</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f1</span> (<span class="id">papp</span> (<span class="id">pval</span> (<span class="id">vfun</span> <span class="id">fromal_arg</span> <span class="id">e</span>)) (<span class="id">pval</span> <span class="id">actual_arg</span>)) <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f2</span> <span class="id">v</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">eval_malloc</span> : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> <span class="id">loc</span> <span class="id">v</span> <span class="id">f'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id">Fmap.indom</span> <span class="id">h</span> <span class="id">loc</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f</span> ((<span class="id">ev</span> <span class="string">"malloc"</span> (<span class="id">vloc</span> <span class="id">loc</span>))::<span class="id">nil</span>) <span class="id">f'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f</span> (<span class="id">pref</span> (<span class="id">pval</span> <span class="id">v</span>)) (<span class="id">Fmap.update</span> <span class="id">h</span> <span class="id">loc</span> <span class="id">v</span>) (<span class="id">r</span>++((<span class="id">ev</span> <span class="string">"malloc"</span> (<span class="id">vloc</span> <span class="id">loc</span>))::<span class="id">nil</span>)) (<span class="id">fc_conj</span> <span class="id">f'</span> (<span class="id">fc_finally</span> (<span class="id">ev</span> <span class="string">"free"</span> (<span class="id">vloc</span> <span class="id">loc</span>)))) (<span class="id">vloc</span> <span class="id">loc</span>)<br/>
.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id">forward</span> : <span class="id">hprop</span> -&gt; <span class="id">theta</span> -&gt; <span class="id">futureCond</span> -&gt; <span class="id">expr</span> -&gt; (<span class="id">val</span> -&gt; <span class="id">hprop</span>) -&gt; <span class="id">theta</span> -&gt; <span class="id">futureCond</span> -&gt; <span class="kwd">Prop</span> :=<br/>
<br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_consequence</span>: <span class="kwd">forall</span> <span class="id">P1</span> <span class="id">P2</span> <span class="id">P3</span> <span class="id">P4</span> <span class="id">t'</span> <span class="id">f'</span> <span class="id">t</span> <span class="id">f</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P3</span> <span class="id">emp</span> <span class="id">fc_default</span> <span class="id">e</span> <span class="id">P4</span> <span class="id">t'</span> <span class="id">f'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P1</span> ==&gt; <span class="id">P3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P4</span> ===&gt; <span class="id">P2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inclusion</span> <span class="id">t'</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f</span> <span class="id">f'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P1</span> <span class="id">emp</span> <span class="id">fc_default</span> <span class="id">e</span> <span class="id">P2</span> <span class="id">t</span> <span class="id">f</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_let</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">Q1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> <span class="id">e1</span> <span class="id">Q</span> <span class="id">t2</span> <span class="id">f2</span>  -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">v</span>, <span class="id">forward</span> (<span class="id">Q</span> <span class="id">v</span>) <span class="id">t2</span> <span class="id">f2</span> (<span class="id">subst</span> <span class="id">x</span> <span class="id">v</span> <span class="id">e2</span>) <span class="id">Q1</span> <span class="id">t3</span> <span class="id">f3</span> ) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">plet</span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span>) <span class="id">Q1</span> <span class="id">t3</span> <span class="id">f3</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_val</span>: <span class="kwd">forall</span> <span class="id">v</span> <span class="id">P</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">pval</span> <span class="id">v</span>) (<span class="kwd">fun</span> <span class="id">res</span> =&gt; <span class="id">P</span> \* \[<span class="id">res</span> = <span class="id">v</span>]) <span class="id">emp</span> <span class="id">fc_default</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_event</span>: <span class="kwd">forall</span> <span class="id">P</span> (<span class="id">ev</span>:<span class="id">event</span>) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">pevent</span> <span class="id">ev</span>) (<span class="kwd">fun</span> <span class="id">res</span> =&gt; <span class="id">P</span> \* \[<span class="id">res</span> = <span class="id">vunit</span>]) (<span class="id">theta_singleton</span> <span class="id">ev</span>) <span class="id">fc_default</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_cond</span> : <span class="kwd">forall</span> (<span class="id">b</span>:<span class="id">bool</span>) <span class="id">e1</span> <span class="id">e2</span> <span class="id">t</span> <span class="id">f</span> <span class="id">P</span> <span class="id">Q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> (<span class="kwd">if</span> <span class="id">b</span> <span class="kwd">then</span> <span class="id">e1</span> <span class="kwd">else</span> <span class="id">e2</span>) <span class="id">Q</span> <span class="id">t</span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">pif</span> (<span class="id">pval</span> (<span class="id">vbool</span> <span class="id">b</span>)) <span class="id">e1</span> <span class="id">e2</span>) <span class="id">Q</span> <span class="id">t</span> <span class="id">f</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_deref</span> : <span class="kwd">forall</span> <span class="id">loc</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> (<span class="id">loc</span> ~~&gt; <span class="id">v</span>) <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">pderef</span> (<span class="id">pval</span>(<span class="id">vloc</span> <span class="id">loc</span>))) (<span class="kwd">fun</span> <span class="id">res</span> =&gt; (<span class="id">loc</span> ~~&gt; <span class="id">v</span>) \* \[<span class="id">res</span> = <span class="id">v</span>]) <span class="id">emp</span> <span class="id">fc_default</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_assign</span> : <span class="kwd">forall</span> <span class="id">loc</span> <span class="id">v</span> <span class="id">v'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> (<span class="id">loc</span> ~~&gt; <span class="id">v'</span>) <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">passign</span> (<span class="id">pval</span>(<span class="id">vloc</span> <span class="id">loc</span>)) (<span class="id">pval</span> <span class="id">v</span>)) (<span class="kwd">fun</span> <span class="id">res</span> =&gt; (<span class="id">loc</span> ~~&gt; <span class="id">v</span>) \* \[<span class="id">res</span> = <span class="id">vunit</span>])  <span class="id">emp</span> <span class="id">fc_default</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_assume</span> : <span class="kwd">forall</span> <span class="id">P</span> <span class="id">f1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">passume</span> <span class="id">f1</span>) (<span class="kwd">fun</span> <span class="id">res</span> =&gt; <span class="id">P</span> \* \[<span class="id">res</span> = <span class="id">vunit</span>]) <span class="id">emp</span> <span class="id">f1</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_app</span> : <span class="kwd">forall</span> <span class="id">fromal_arg</span> <span class="id">e</span> <span class="id">actual_arg</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">t</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">subst</span> <span class="id">fromal_arg</span> <span class="id">actual_arg</span> <span class="id">e</span>) <span class="id">Q</span> <span class="id">t</span> <span class="id">f</span>  -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">papp</span> (<span class="id">pval</span> (<span class="id">vfun</span> <span class="id">fromal_arg</span> <span class="id">e</span>)) (<span class="id">pval</span> <span class="id">actual_arg</span>)) <span class="id">Q</span> <span class="id">t</span> <span class="id">f</span><br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_structural</span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">t</span> <span class="id">f</span> <span class="id">f_ctx</span> <span class="id">t_ctx</span> <span class="id">f_ctx'</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> <span class="id">e</span> <span class="id">Q</span> <span class="id">t</span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f_ctx</span> <span class="id">t</span> <span class="id">f_ctx'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">t_ctx</span> <span class="id">f_ctx</span> <span class="id">e</span> <span class="id">Q</span> (<span class="id">seq</span> <span class="id">t_ctx</span> <span class="id">t</span>) (<span class="id">fc_conj</span> <span class="id">f_ctx'</span> <span class="id">f</span>)<br/>
<br/>
&nbsp;&nbsp;| <span class="id">fw_malloc</span> : <span class="kwd">forall</span> <span class="id">P</span> <span class="id">v</span> <span class="id">h</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">emp</span> <span class="id">fc_default</span> (<span class="id">pref</span> (<span class="id">pval</span> (<span class="id">v</span>))) (<span class="kwd">fun</span> <span class="id">res</span> =&gt; <span class="id">P</span> \* <span class="id">h</span> ~~&gt; <span class="id">v</span> \* \[<span class="id">res</span> = (<span class="id">vloc</span> <span class="id">h</span>)]) (<span class="id">theta_singleton</span> (<span class="id">ev</span> <span class="string">"malloc"</span> (<span class="id">vloc</span> <span class="id">h</span>))) (<span class="id">fc_singleton</span>(<span class="id">seq</span> (<span class="id">trace_default</span>) (<span class="id">theta_singleton</span> (<span class="id">ev</span> <span class="string">"free"</span> (<span class="id">vloc</span> <span class="id">h</span>)))))<br/>
<br/>
.<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">strenthen_futureCond_big_step</span> : <span class="kwd">forall</span> <span class="id">h1</span> <span class="id">r1</span> <span class="id">f1</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">r2</span> <span class="id">f2</span> <span class="id">v</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">r1</span> <span class="id">f1</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">r2</span> <span class="id">f2</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f3</span> <span class="id">f1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f4</span>,<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">r1</span> <span class="id">f3</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">r2</span> (<span class="id">fc_conj</span> <span class="id">f4</span> <span class="id">f2</span>) <span class="id">v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">f3</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep1</span> <span class="id">f0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep1</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep2</span> (<span class="id">fc_conj</span> <span class="id">f4</span> <span class="id">f2</span>)).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureCondEntail_conj_LHS_2</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">f4</span> <span class="id">f2</span> <span class="id">f2</span> (<span class="id">futureCondEntail_exact</span> <span class="id">f2</span>) ).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep2</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f5</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">eval_plet</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">v</span> <span class="id">r</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">rho3</span> <span class="id">f0</span> (<span class="id">fc_conj</span> <span class="id">f4</span> <span class="id">f2</span>) (<span class="id">fc_conj</span> <span class="id">f5</span> <span class="id">f3</span>) <span class="id">H2</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">eval_const</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">h</span> <span class="id">r</span> <span class="id">f3</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">futureCondEntail_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f3</span> <span class="id">f</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f0</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep</span> <span class="id">f3</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">futureCondEntail_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f3</span> <span class="id">f</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep</span> <span class="id">f3</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">futureCondEntail_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f3</span> <span class="id">f</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">futureCondEntail_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f3</span> <span class="id">f</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">fc_assio</span> <span class="id">f0</span> <span class="id">f</span> <span class="id">f_assume</span>).<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureCondEntail_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">f3</span> <span class="id">f</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H1</span>. <span class="id">subst</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">all_future_condition_has_futureSubtraction_linear</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f0</span> (<span class="id">ev0</span> :: <span class="id">nil</span>)).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f'0</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H</span>.<br/>
<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">futureCondEntail_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f3</span> <span class="id">f</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f0</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">futureCondEntail_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f3</span> <span class="id">f</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f0</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep</span> <span class="id">f3</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">futureCondEntail_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f3</span> <span class="id">f</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">all_future_condition_has_futureSubtraction_linear</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">f0</span> (<span class="id">ev</span> <span class="string">"malloc"</span> (<span class="id">vloc</span> <span class="id">loc0</span>) :: <span class="id">nil</span>)).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">f'0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">futureCond_distr</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">fc_comm</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H3</span>.<br/>
<br/>
Qed.</div></details>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">forward_only_appending_trace</span>: <span class="kwd">forall</span> <span class="id">P</span> <span class="id">t1</span> <span class="id">f1</span> <span class="id">e</span> <span class="id">Q</span> <span class="id">t2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">t1</span> <span class="id">f1</span> <span class="id">e</span> <span class="id">Q</span> <span class="id">t2</span> <span class="id">f3</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">t3</span>,<br/>
&nbsp;&nbsp;<span class="id">t2</span> = <span class="id">seq</span> <span class="id">t1</span> <span class="id">t3</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normal_emp</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHforward</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">t3</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normal_emp</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">emp</span>. <span class="id">rewrite</span> <span class="id">normal_emp</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">theta_singleton</span> <span class="id">ev0</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normal_emp</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHforward</span>. <span class="kwd">exists</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normal_emp</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">emp</span>. <span class="id">rewrite</span> <span class="id">normal_emp</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">emp</span>. <span class="id">rewrite</span> <span class="id">normal_emp</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">emp</span>. <span class="id">rewrite</span> <span class="id">normal_emp</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHforward</span>. <span class="kwd">exists</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normal_emp</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">t</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">theta_singleton</span> (<span class="id">ev</span> <span class="string">"malloc"</span> (<span class="id">vloc</span> <span class="id">h</span>))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normal_emp</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">future_frame_big_step_aux_aux</span> : <span class="kwd">forall</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f1</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f2</span> <span class="id">v</span> <span class="id">rho</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f1</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f2</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">rho3</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho</span> <span class="id">f</span> <span class="id">e</span> <span class="id">h2</span> (<span class="id">rho</span>++<span class="id">rho3</span>) <span class="id">f3</span> <span class="id">v</span> /\<br/>
&nbsp;&nbsp;<span class="id">rho2</span> = <span class="id">rho1</span> ++ <span class="id">rho3</span> .<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho0</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep1</span> <span class="id">rho0</span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep1</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep2</span> (<span class="id">rho0</span> ++ <span class="id">rho4</span>) <span class="id">f0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span>  <span class="id">IHbigstep2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">rho4</span>++<span class="id">rho5</span>) <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">eval_plet</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">v</span> <span class="id">r</span> <span class="id">rho0</span> (<span class="id">rho0</span> ++ <span class="id">rho4</span>) ((<span class="id">rho0</span> ++ <span class="id">rho4</span>) ++ <span class="id">rho5</span>) <span class="id">f</span> <span class="id">f0</span> <span class="id">f4</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;((_&nbsp;++&nbsp;_)&nbsp;++&nbsp;_&nbsp;).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">List.app_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">List.app_assoc</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">nil</span>:<span class="id">rho</span>) <span class="id">f0</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">List.app_nil_r</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">List.app_nil_r</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep</span> <span class="id">rho0</span> <span class="id">f0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">rho3</span> <span class="id">f3</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep</span> <span class="id">rho0</span> <span class="id">f0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">rho3</span> <span class="id">f3</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">nil</span>:<span class="id">rho</span>) (<span class="id">fc_conj</span> <span class="id">f0</span> <span class="id">f_assume</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">List.app_nil_r</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">List.app_nil_r</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">all_future_condition_has_futureSubtraction_linear</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">f0</span> (<span class="id">ev0</span>::<span class="id">nil</span>)).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">ev0</span>::<span class="id">nil</span>) <span class="id">f'0</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">nil</span>:<span class="id">rho</span>) <span class="id">f0</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">List.app_nil_r</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.  <span class="id">rewrite</span> <span class="id">List.app_nil_r</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">nil</span>:<span class="id">rho</span>) <span class="id">f0</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">List.app_nil_r</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.  <span class="id">rewrite</span> <span class="id">List.app_nil_r</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep</span> <span class="id">rho0</span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">rho3</span>) (<span class="id">f3</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">ev</span> <span class="string">"malloc"</span> (<span class="id">vloc</span> <span class="id">loc0</span>) :: <span class="id">nil</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">all_future_condition_has_futureSubtraction_linear</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">f0</span> (<span class="id">ev</span> <span class="string">"malloc"</span> (<span class="id">vloc</span> <span class="id">loc0</span>) :: <span class="id">nil</span>)).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">fc_conj</span> <span class="id">f'0</span> (<span class="id">fc_finally</span> (<span class="id">ev</span> <span class="string">"free"</span> (<span class="id">vloc</span> <span class="id">loc0</span>)))).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>. <span class="id">exact</span> <span class="id">H2</span>. <span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Axiom</span> <span class="id">identity</span> : <span class="kwd">forall</span> [<span class="id">A</span>: <span class="kwd">Type</span>] (<span class="id">x</span>:<span class="id">A</span>), <span class="id">x</span> = <span class="id">x</span>.<br/>
<span class="kwd">Axiom</span> <span class="id">identity1</span> : <span class="kwd">forall</span>  (<span class="id">x</span>:<span class="kwd">Prop</span>) (<span class="id">y</span>:<span class="kwd">Prop</span>), (<span class="id">x</span> = <span class="id">y</span>) -&gt; <span class="id">y</span> -&gt; <span class="id">x</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">all_future_Cond_can_be_split_into_two_conjunctive_cases</span>: <span class="kwd">forall</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f1</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;<span class="id">f</span> = (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id">fc_singleton</span> <span class="id">t</span>) <span class="id">fc_default</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">fc_comm</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">f_conj_kleene_any_is_f</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHf1</span>.<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHf2</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">fc_conj</span> <span class="id">f0</span> <span class="id">f3</span>) (<span class="id">fc_conj</span> <span class="id">f4</span> <span class="id">f5</span>).<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Axiom</span> <span class="id">distribute_futureSubtraction</span>: <span class="kwd">forall</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">t</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">t</span><br/>
<span class="id">f3</span> -&gt;<br/>
<span class="kwd">exists</span> <span class="id">f4</span> <span class="id">f5</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f1</span> <span class="id">t</span> <span class="id">f4</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f2</span> <span class="id">t</span> <span class="id">f5</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f3</span> = <span class="id">fc_conj</span> <span class="id">f4</span> <span class="id">f5</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">futureCondEntail_linear_distrbute</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">f'</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">rho</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f</span> <span class="id">rho</span> <span class="id">f'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">f</span> = (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f1'</span> <span class="id">f2'</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f1</span> <span class="id">rho</span> <span class="id">f1'</span> /\<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f2</span> <span class="id">rho</span> <span class="id">f2'</span> /\<br/>
&nbsp;&nbsp;<span class="id">f'</span> = (<span class="id">fc_conj</span> <span class="id">f1'</span> <span class="id">f2'</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">f1</span> <span class="id">f2</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">identity</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">all_future_Cond_can_be_split_into_two_conjunctive_cases</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">all_future_Cond_can_be_split_into_two_conjunctive_cases</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">e</span> <span class="id">f5</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction_linear1</span> <span class="id">f1</span> <span class="id">f2</span> (<span class="id">H1</span> <span class="id">futureCond</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>))).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction_linear1</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction_linear2</span> <span class="id">f6</span> <span class="id">f7</span> (<span class="id">H1</span> <span class="id">futureCond</span> (<span class="id">fc_conj</span> <span class="id">f6</span> <span class="id">f7</span>))).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction_linear2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f3</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H</span>. <span class="id">split</span>. <span class="id">exact</span> <span class="id">H0</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f1</span> <span class="id">f2</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">all_future_Cond_can_be_split_into_two_conjunctive_cases</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">f_der</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction_linear</span> <span class="id">f0</span> <span class="id">f3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">fc_conj_not_bot</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">a</span>  <span class="id">f0</span> <span class="id">f3</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction_linear</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureSubtraction_linear_induc</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">identity</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f1'</span> <span class="id">f2'</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">ev0</span> <span class="id">f1</span> <span class="id">f0</span> (<span class="id">ev0</span> :: <span class="id">t_der</span>) <span class="id">t_der</span> <span class="id">f1'</span> <span class="id">H12</span> <span class="id">H1</span> (<span class="id">e</span> <span class="id">rho</span> (<span class="id">ev0</span> :: <span class="id">t_der</span>)) <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">ev0</span> <span class="id">f2</span> <span class="id">f3</span> (<span class="id">ev0</span> :: <span class="id">t_der</span>) <span class="id">t_der</span> <span class="id">f2'</span> <span class="id">H14</span> <span class="id">H3</span> (<span class="id">e</span> <span class="id">rho</span> (<span class="id">ev0</span> :: <span class="id">t_der</span>)) <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">distrbuteBigStepLHS</span>: <span class="kwd">forall</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f0</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f0</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">f</span> = (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f3</span> <span class="id">f4</span>,<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f1</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f3</span> <span class="id">v</span> /\<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f2</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f4</span> <span class="id">v</span>  /\ <span class="id">f0</span> = <span class="id">fc_conj</span> <span class="id">f3</span> <span class="id">f4</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">f1</span> <span class="id">f2</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep1</span> <span class="id">f0</span> <span class="id">f4</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep1</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep2</span> <span class="id">f5</span> <span class="id">f6</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep2</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f7</span> <span class="id">f8</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">eval_plet</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">v</span> <span class="id">r</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">rho3</span> <span class="id">f0</span> <span class="id">f5</span> <span class="id">f7</span> <span class="id">H2</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">eval_plet</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">v</span> <span class="id">r</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">rho3</span> <span class="id">f4</span> <span class="id">f6</span> <span class="id">f8</span> <span class="id">H3</span> <span class="id">H6</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H1</span>. <span class="id">split</span>. <span class="id">exact</span> <span class="id">H5</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f1</span> <span class="id">f2</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">identity</span> ).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep</span> <span class="id">f1</span> <span class="id">f2</span> (<span class="id">H0</span> <span class="id">futureCond</span> (<span class="id">fc_conj</span>  <span class="id">f1</span> <span class="id">f2</span>))).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f3</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H1</span>. <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H2</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">identity</span> ).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep</span> <span class="id">f1</span> <span class="id">f2</span> (<span class="id">H0</span> <span class="id">futureCond</span> (<span class="id">fc_conj</span>  <span class="id">f1</span> <span class="id">f2</span>))).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f3</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H1</span>. <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H2</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f_assume</span>) (<span class="id">fc_conj</span> <span class="id">f2</span> <span class="id">f_assume</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">split</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">futureCond_distr2</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureCondEntail_linear_distrbute</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">identity</span> ).<br/>
<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">f'</span> <span class="id">f1</span> <span class="id">f2</span> (<span class="id">ev0</span> :: <span class="id">nil</span>)%<span class="id">mylist</span> <span class="id">H</span> (<span class="id">H1</span> <span class="id">futureCond</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>))).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H0</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f1'</span> <span class="id">f2'</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H2</span>. <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f1</span> <span class="id">f2</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.  <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.  <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f1</span> <span class="id">f2</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.  <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.  <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">identity</span> ).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep</span> <span class="id">f0</span> <span class="id">f3</span> (<span class="id">H0</span> <span class="id">futureCond</span> (<span class="id">fc_conj</span> <span class="id">f0</span> <span class="id">f3</span>))).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHbigstep</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f1</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H1</span>. <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H2</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">distribute_futureSubtraction</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">f1</span> <span class="id">f2</span> (<span class="id">ev</span> <span class="string">"malloc"</span> (<span class="id">vloc</span> <span class="id">loc0</span>) :: <span class="id">nil</span>) <span class="id">f'</span> <span class="id">H0</span>). <span class="id">destr</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">fc_conj</span> <span class="id">f4</span> (<span class="id">fc_finally</span> (<span class="id">ev</span> <span class="string">"free"</span> (<span class="id">vloc</span> <span class="id">loc0</span>)))) (<span class="id">fc_conj</span> <span class="id">f5</span> (<span class="id">fc_finally</span> (<span class="id">ev</span> <span class="string">"free"</span> (<span class="id">vloc</span> <span class="id">loc0</span>)))).<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.  <span class="id">exact</span> <span class="id">H2</span>. <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>. <span class="id">rewrite</span> <span class="id">futureCond_distr2</span>.  <span class="id">reflexivity</span>.<br/>
<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">big_step_nil_context</span>: <span class="kwd">forall</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f_ctx</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">h3</span> <span class="id">rho2</span> <span class="id">f3</span> <span class="id">v</span> <span class="id">rho3</span> <span class="id">f0</span>  <span class="id">f_ctx'</span>,<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f_ctx</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f3</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">rho2</span> = (<span class="id">rho1</span> ++ <span class="id">rho3</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">nil</span> <span class="id">fc_default</span> <span class="id">e</span> <span class="id">h3</span> <span class="id">rho3</span> <span class="id">f0</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f_ctx</span> <span class="id">rho3</span> <span class="id">f_ctx'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">f3</span> = <span class="id">fc_conj</span> <span class="id">f0</span> <span class="id">f_ctx'</span>.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">futureCondEntail_fc_der_indicate</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">f3</span> <span class="id">ev0</span> <span class="id">f_der</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f</span> <span class="id">f3</span> -&gt;  <span class="id">fc_der</span> <span class="id">f</span> <span class="id">ev0</span> <span class="id">f_der</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">f_der</span> &lt;&gt; <span class="id">fc_singleton</span> <span class="id">bot</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">deriv</span>, <span class="id">fc_der</span> <span class="id">f3</span> <span class="id">ev0</span> <span class="id">deriv</span> /\ <span class="id">deriv</span> &lt;&gt; <span class="id">fc_singleton</span> <span class="id">bot</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">fc_singleton_is_not_conj</span> : <span class="kwd">forall</span> <span class="id">t</span> <span class="id">f1</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;<span class="id">fc_singleton</span> <span class="id">t</span> &lt;&gt; <span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>.<br/>
<br/>
<span class="kwd">Axiom</span> <span class="id">futureCondEntail_conj_left_indicates</span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">f0</span> <span class="id">f1</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f</span> <span class="id">f0</span> -&gt;  <span class="id">f</span> = (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f0</span> \/ <span class="id">futureCondEntail</span> <span class="id">f2</span> <span class="id">f0</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">weakening_futureSubtraction_linear</span> : <span class="kwd">forall</span>  <span class="id">f1</span> <span class="id">rho3</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f1</span> <span class="id">rho3</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> <span class="id">f1</span> <span class="id">f3</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f4</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f3</span> <span class="id">rho3</span> <span class="id">f4</span> /\ <span class="id">futureCondEntail</span> <span class="id">f2</span> <span class="id">f4</span> .<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">f3</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">identity</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureCondEntail_conj_left_indicates</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> ( <span class="id">H2</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>) <span class="id">f0</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">H1</span> (<span class="id">e</span> <span class="id">futureCond</span> (<span class="id">fc_conj</span> <span class="id">f1</span> <span class="id">f2</span>))).<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction_linear1</span> <span class="id">f0</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction_linear1</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f5</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_1</span>. <span class="id">exact</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction_linear2</span> <span class="id">f0</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction_linear2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f5</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_2</span>. <span class="id">exact</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f3</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureCondEntail_fc_der_indicate</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">f</span> <span class="id">f3</span> <span class="id">ev0</span> <span class="id">f_der</span> <span class="id">H3</span> <span class="id">H</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction_linear</span> <span class="id">deriv</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureCondEntail_rev</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">f</span> <span class="id">f3</span> <span class="id">ev0</span> <span class="id">f_der</span> <span class="id">deriv</span> <span class="id">H3</span> <span class="id">H</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction_linear</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction_linear</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">futureSubtraction_linear_induc</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">identity</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">f0</span> <span class="id">ev0</span> <span class="id">f3</span> <span class="id">deriv</span> (<span class="id">ev0</span>::<span class="id">t_der</span>) <span class="id">t_der</span> <span class="id">f4</span> <span class="id">H4</span> <span class="id">H6</span> (<span class="id">e</span> <span class="id">rho</span> (<span class="id">ev0</span>::<span class="id">t_der</span>)) <span class="id">H8</span>).<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">f0</span>. <span class="id">exact</span> <span class="id">H9</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">futureSubtraction_strengthing_linear_res</span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f_ctx</span> <span class="id">t</span> <span class="id">f_ctx'</span> <span class="id">rho3</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f_ctx</span> <span class="id">t</span> <span class="id">f_ctx'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho3</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f_ctx'0</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction_linear</span> <span class="id">f_ctx</span> <span class="id">rho3</span> <span class="id">f_ctx'0</span>  /\ <span class="id">futureCondEntail</span> <span class="id">f_ctx'</span> <span class="id">f_ctx'0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho3</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction1</span> <span class="id">rho3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction2</span> <span class="id">rho3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction1</span>.<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">fc_conj</span> <span class="id">f_ctx'0</span> <span class="id">f_ctx'1</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H3</span>. <span class="id">exact</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_RHS</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_1</span>. <span class="id">exact</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_2</span>. <span class="id">exact</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">fc_singleton</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">constructor</span>. <span class="id">constructor</span>. <span class="id">exact</span> (<span class="id">inclusion_exact</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">case_spliting_helper_bot</span> <span class="id">t_der</span>).<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">derivative_model_false</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">t</span> <span class="id">ev0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">false</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span>  <span class="id">derivative_model</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">t</span> <span class="id">ev0</span> <span class="id">t_der</span> <span class="id">rho3</span> <span class="id">H1</span> <span class="id">H5</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction</span> <span class="id">rho1</span> <span class="id">H7</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureSubtraction_linear_induc</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">ev0</span> <span class="id">f</span> <span class="id">f_der</span> <span class="id">rho3</span> <span class="id">rho1</span> <span class="id">f_ctx'0</span> <span class="id">H</span> <span class="id">H0</span> <span class="id">H4</span> <span class="id">H8</span>).<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f_ctx'0</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H6</span>. <span class="id">exact</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction</span> <span class="id">rho3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f_ctx'0</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> (<span class="id">futureCondEntail_trans</span> ).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">f0</span> <span class="id">f2</span> <span class="id">f1</span> <span class="id">f_ctx'0</span> <span class="id">H0</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">f0</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction</span> <span class="id">rho3</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">weakening_futureSubtraction_linear</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">f1</span> <span class="id">rho3</span> <span class="id">f_ctx'0</span> <span class="id">f3</span> <span class="id">H3</span> <span class="id">H0</span> ).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f4</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">futureCondEntail_trans</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> (<span class="id">H5</span> <span class="id">f2</span> <span class="id">f_ctx'0</span> <span class="id">f4</span> <span class="id">H4</span> <span class="id">H6</span>).<br/>
<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">inclusion_sound</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">t'</span> <span class="id">t</span> <span class="id">rho3</span> <span class="id">H0</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHfutureSubtraction</span> <span class="id">rho3</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHfutureSubtraction</span>.<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">f_ctx'0</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H5</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">futureSubtraction_trace_model_futureSubtraction_linear</span>:<br/>
<span class="kwd">forall</span> <span class="id">f_ctx</span> <span class="id">t</span> <span class="id">f_ctx'</span> <span class="id">rho3</span> <span class="id">h1</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho1</span> <span class="id">f3</span> <span class="id">v</span> <span class="id">f0</span>,<br/>
&nbsp;&nbsp;<span class="id">futureSubtraction</span> <span class="id">f_ctx</span> <span class="id">t</span> <span class="id">f_ctx'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho3</span> <span class="id">t</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f_ctx</span> <span class="id">e</span> <span class="id">h2</span> (<span class="id">rho1</span> ++ <span class="id">rho3</span>) <span class="id">f3</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">nil</span> <span class="id">fc_default</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho3</span> <span class="id">f0</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">futureCondEntail</span> (<span class="id">fc_conj</span> <span class="id">f_ctx'</span> <span class="id">f0</span>) <span class="id">f3</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">big_step_nil_context</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">identity</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureSubtraction_strengthing_linear_res</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">f_ctx</span> <span class="id">t</span> <span class="id">f_ctx'</span> <span class="id">rho3</span> <span class="id">H</span> <span class="id">H0</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H3</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f_ctx</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">h2</span> (<span class="id">rho1</span> ++ <span class="id">rho3</span>) <span class="id">f3</span> <span class="id">v</span> <span class="id">rho3</span> <span class="id">f0</span> <span class="id">f_ctx'0</span> <span class="id">H1</span> (<span class="id">e0</span> <span class="id">rho</span> (<span class="id">rho1</span>++<span class="id">rho3</span>)) <span class="id">H2</span> <span class="id">H4</span>). <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_RHS</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_2</span>. <span class="id">exact</span> (<span class="id">futureCondEntail_exact</span> <span class="id">f0</span>) .<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_1</span>. <span class="id">exact</span> <span class="id">H6</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Lemma</span> <span class="id">bigstep_framing_trace</span>: <span class="kwd">forall</span> <span class="id">h3</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho0</span> <span class="id">f3</span> <span class="id">v</span> <span class="id">rho3</span> <span class="id">rho1</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h3</span> <span class="id">rho1</span> <span class="id">f</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho0</span> <span class="id">f3</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h3</span> (<span class="id">rho3</span>++<span class="id">rho1</span>) <span class="id">f</span> <span class="id">e</span> <span class="id">h2</span> (<span class="id">rho3</span> ++ <span class="id">rho0</span>) <span class="id">f3</span> <span class="id">v</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">rho3</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep1</span> <span class="id">rho0</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHbigstep2</span> <span class="id">rho0</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">eval_plet</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">h3</span> <span class="id">x</span> <span class="id">e1</span> <span class="id">e2</span> <span class="id">v</span> <span class="id">r</span> (<span class="id">rho0</span> ++ <span class="id">rho1</span>) (<span class="id">rho0</span> ++ <span class="id">rho2</span>) (<span class="id">rho0</span> ++ <span class="id">rho3</span>) <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span> <span class="id">IHbigstep1</span> <span class="id">IHbigstep2</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">constructor</span>. <span class="id">exact</span> (<span class="id">IHbigstep</span> <span class="id">rho3</span>).<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">constructor</span>. <span class="id">exact</span> (<span class="id">IHbigstep</span> <span class="id">rho3</span>).<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id">List.app_assoc</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">intros</span>. <span class="id">constructor</span>. <span class="id">exact</span> (<span class="id">IHbigstep</span> <span class="id">rho3</span>).<br/>
&nbsp;&nbsp;- <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">List.app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">H</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">heap_disjoint_consequence_aux</span>: <span class="kwd">forall</span> [<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>] (<span class="id">h1</span>:<span class="id">Fmap.fmap</span> <span class="id">A</span> <span class="id">B</span>) <span class="id">h2</span> <span class="id">h3</span>,<br/>
&nbsp;&nbsp;<span class="id">Fmap.disjoint</span> <span class="id">h1</span> <span class="id">h2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Fmap.disjoint</span> <span class="id">h2</span> <span class="id">h3</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Fmap.disjoint</span> <span class="id">h1</span> <span class="id">h3</span>-&gt;<br/>
&nbsp;&nbsp;<span class="id">Fmap.disjoint</span> <span class="id">h1</span> (<span class="id">h2</span> \<span class="id">u</span> <span class="id">h3</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span>  <span class="id">disjoint_union_eq_r</span>.<br/>
&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Axiom</span> <span class="id">h_subst_pure</span>: <span class="kwd">forall</span> (<span class="id">t1</span>:<span class="id">loc</span>) <span class="id">t2</span>, <span class="id">t1</span> = <span class="id">t2</span>.<br/>
<br/>
<br/>
<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id">soundness</span> : <span class="kwd">forall</span> <span class="id">P</span> <span class="id">e</span> <span class="id">Q</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">h1</span> <span class="id">v</span> <span class="id">h2</span> <span class="id">f1</span> <span class="id">f2</span> <span class="id">f3</span>,<br/>
&nbsp;&nbsp;<span class="id">forward</span> <span class="id">P</span> <span class="id">t1</span> <span class="id">f1</span> <span class="id">e</span> <span class="id">Q</span> <span class="id">t2</span> <span class="id">f2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">P</span> <span class="id">h1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">trace_model</span> <span class="id">rho1</span> <span class="id">t1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">bigstep</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f1</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f3</span> <span class="id">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Q</span> <span class="id">v</span> <span class="id">h2</span> /\ <span class="id">trace_model</span> <span class="id">rho2</span> <span class="id">t2</span> /\ <span class="id">futureCondEntail</span> <span class="id">f2</span> <span class="id">f3</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">introv</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">gen</span> <span class="id">h1</span> <span class="id">v</span> <span class="id">h2</span> <span class="id">rho1</span> <span class="id">rho2</span> <span class="id">f3</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;consequence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">himpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">h1</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHforward</span> <span class="id">h1</span> <span class="id">H0</span> <span class="id">v</span> <span class="id">h2</span> <span class="id">rho1</span> <span class="id">H5</span> <span class="id">rho2</span> <span class="id">f3</span> <span class="id">H6</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHforward</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">qimpl</span>, <span class="id">himpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H1</span> <span class="id">v</span> <span class="id">h2</span> <span class="id">H7</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">inclusion_sound</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">t'</span> <span class="id">t</span> <span class="id">rho2</span> <span class="id">H2</span> <span class="id">H9</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureCondEntail_trans</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H8</span> <span class="id">f</span> <span class="id">f'</span> <span class="id">f3</span> <span class="id">H3</span> <span class="id">H10</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H8</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;let&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H4</span>. <span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHforward</span> <span class="id">h1</span> <span class="id">H2</span> <span class="id">v0</span> <span class="id">h3</span> <span class="id">rho1</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHforward</span> <span class="id">H3</span> <span class="id">rho3</span> <span class="id">f4</span> <span class="id">H15</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHforward</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H0</span> <span class="id">v0</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">strenthen_futureCond_big_step</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> <span class="id">h3</span> <span class="id">rho3</span> <span class="id">f4</span> (<span class="id">subst</span> <span class="id">x</span> <span class="id">v0</span> <span class="id">e2</span>) <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f0</span> <span class="id">v</span> <span class="id">f2</span> <span class="id">H16</span> <span class="id">H7</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H5</span> <span class="kwd">as</span> (<span class="id">x0</span>&amp;<span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span>(<span class="id">H1</span> <span class="id">v0</span> <span class="id">h3</span> <span class="id">H4</span> <span class="id">v</span> <span class="id">h2</span> <span class="id">rho3</span> <span class="id">H6</span> <span class="id">rho2</span> (<span class="id">fc_conj</span> <span class="id">x0</span> <span class="id">f0</span>) <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span>. <span class="id">destruct</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">f_entail_conj_indicate</span> ).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H10</span> <span class="id">f3</span> <span class="id">x0</span> <span class="id">f0</span> <span class="id">H9</span>). <span class="id">destr</span> <span class="id">H10</span>. <span class="id">exact</span> <span class="id">H12</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;val&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">hstar_hpure_r</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">subst</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">subst</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_exact</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;event&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">hstar_hpure_r</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">trace_model_emp_must_nil</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">rho1</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(nil&nbsp;++&nbsp;_).&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">List.app_nil_l</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">subtract_linear_FromTrueISTrue</span> <span class="kwd">as</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">ev0</span> <span class="id">f3</span> <span class="id">H6</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_exact</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;if-else&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHforward</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IHforward</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H13</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;deref&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">hstar_hpure_r</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">hsingle_inv</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Fmap.read_single</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_exact</span>.<br/>
<br/>
<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;assign&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">hstar_hpure_r</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">hsingle_inv</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Fmap.update_single</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(Fmap.single&nbsp;_&nbsp;_&nbsp;).&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">hsingle_intro</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.  <span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_exact</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*assume*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">hstar_hpure_r</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span>  <span class="id">f_conj_kleene_any_is_f</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_exact</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;fun&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHforward</span> <span class="id">h1</span> <span class="id">H0</span> <span class="id">v</span> <span class="id">h2</span> <span class="id">rho1</span> <span class="id">H1</span> <span class="id">rho2</span> <span class="id">f3</span> <span class="id">H13</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHforward</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H4</span>. <span class="id">exact</span> <span class="id">H5</span>.<br/>
<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;STRUCTURAL&nbsp;RULE&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHforward</span> <span class="id">h1</span> <span class="id">H1</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">future_frame_big_step_aux_aux</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">h1</span> <span class="id">rho1</span> <span class="id">f_ctx</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho2</span> <span class="id">f3</span> <span class="id">v</span> <span class="id">nil</span> <span class="id">fc_default</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHforward</span> <span class="id">h2</span> <span class="id">nil</span> <span class="id">tm_emp</span> <span class="id">rho3</span> <span class="id">f0</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">destr</span> <span class="id">IHforward</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H2</span>. <span class="id">exact</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureSubtraction_trace_model_futureSubtraction_linear</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">List.app_nil_l</span> <span class="kwd">in</span> <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> <span class="id">f_ctx</span> <span class="id">t</span> <span class="id">f_ctx'</span>  <span class="id">rho3</span> <span class="id">h1</span> <span class="id">e</span> <span class="id">h2</span> <span class="id">rho1</span> <span class="id">f3</span> <span class="id">v</span> <span class="id">f0</span> <span class="id">H0</span> <span class="id">H8</span> <span class="id">H3</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">futureCondEntail_trans</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H7</span> (<span class="id">fc_conj</span> <span class="id">f_ctx'</span> <span class="id">f</span>) (<span class="id">fc_conj</span> <span class="id">f_ctx'</span> <span class="id">f0</span>) <span class="id">f3</span> ).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_RHS</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_1</span>. <span class="id">exact</span> (<span class="id">futureCondEntail_exact</span> <span class="id">f_ctx'</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">futureCondEntail_conj_LHS_2</span>. <span class="id">exact</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H6</span>.<br/>
<br/>
&nbsp;&nbsp;-<br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">invert</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">h_subst_pure</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">loc0</span> <span class="id">h</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(~&nbsp;Fmap.indom&nbsp;_&nbsp;_).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">Fmap.update</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(_&nbsp;\u&nbsp;_).&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">Fmap.union_comm_of_disjoint</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">loc</span> <span class="id">val</span> (<span class="id">Fmap.single</span> <span class="id">h</span> <span class="id">v</span>) <span class="id">h1</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(~&nbsp;Fmap.indom&nbsp;_&nbsp;_).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">Fmap.disjoint_single_of_not_indom</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H2</span> <span class="id">loc</span> <span class="id">val</span> <span class="id">h1</span> <span class="id">h</span> <span class="id">v</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(&nbsp;_&nbsp;\*&nbsp;_&nbsp;=&nbsp;_&nbsp;\*&nbsp;_).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">hstar_comm</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>* <span class="id">hstar_intro</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(Fmap.single&nbsp;_&nbsp;_).&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">hsingle_intro</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H4</span> <span class="id">h</span> <span class="id">v</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(_&nbsp;\*&nbsp;_).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">hstar_hpure_l</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Search&nbsp;(_&nbsp;\*&nbsp;_).&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">hstar_comm</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H5</span> (<span class="id">vloc</span> <span class="id">h</span> = <span class="id">vloc</span> <span class="id">h</span>) (<span class="id">h</span> ~~&gt; <span class="id">v</span>) (<span class="id">Fmap.single</span> <span class="id">h</span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">identity1</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H6</span> ((\[<span class="id">vloc</span> <span class="id">h</span> = <span class="id">vloc</span> <span class="id">h</span>] \* <span class="id">h</span> ~~&gt; <span class="id">v</span>) (<span class="id">Fmap.single</span> <span class="id">h</span> <span class="id">v</span>)) (<span class="id">vloc</span> <span class="id">h</span> = <span class="id">vloc</span> <span class="id">h</span> /\<br/>
(<span class="id">h</span> ~~&gt; <span class="id">v</span>) (<span class="id">Fmap.single</span> <span class="id">h</span> <span class="id">v</span>)) <span class="id">H5</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H6</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id">normal_emp</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">subtract_linear_FromTrueISTrue</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> (<span class="id">ev</span> <span class="string">"malloc"</span> (<span class="id">vloc</span> <span class="id">h</span>)) <span class="id">f'</span> <span class="id">H7</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">anything_future_entail_default</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> (<span class="id">H</span> (<span class="id">fc_singleton</span> (<span class="id">seq</span> <span class="id">trace_default</span> (<span class="id">theta_singleton</span> (<span class="id">ev</span> <span class="string">"free"</span> (<span class="id">vloc</span> <span class="id">h</span>)))))).<br/>
&nbsp;&nbsp;<span class="id">unfold</span>  <span class="id">fc_finally</span>. <span class="id">unfold</span> <span class="id">trace_finally</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> (<span class="id">futureCondEntail_exact</span> (<span class="id">fc_singleton</span> (<span class="id">seq</span> <span class="id">trace_default</span> (<span class="id">theta_singleton</span> (<span class="id">ev</span> <span class="string">"free"</span> (<span class="id">vloc</span> <span class="id">h</span>)))))).<br/>
<br/>
Qed.</div></details>
<br/>
<span class="kwd">Module</span> <span class="id">Examples</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">e1</span> := (<span class="id">pval</span> <span class="id">vunit</span>).<br/>
<br/>
<span class="kwd">Example</span> <span class="id">forward_e1</span>:<br/>
&nbsp;&nbsp;<span class="id">forward</span> <span class="id">hempty</span> <span class="id">emp</span> <span class="id">fc_default</span> <span class="id">e1</span> (<span class="kwd">fun</span> <span class="id">res</span> : <span class="id">val</span> =&gt; \[] \* \[<span class="id">res</span> = <span class="id">vunit</span>]) <span class="id">emp</span> <span class="id">fc_default</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">fw_val</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">vunit</span> \[] ).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H</span>.<br/>
Qed.</div></details>
<br/>
<span class="kwd">Definition</span> <span class="id">e2</span> := (<span class="id">pval</span> <span class="id">vunit</span>).<br/>
<br/>
<span class="kwd">End</span> <span class="id">Examples</span>.
</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
